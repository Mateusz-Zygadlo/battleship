(()=>{"use strict";const e=e=>{const t=document.querySelector(".gameboard");t.textContent="";for(let o=0;o<10;o++)for(let l=0;l<10;l++)if("x"==e[o][l]){const e=document.createElement("div");e.classList.add("checked"),e.dataset.row=o,e.dataset.column=l,t.appendChild(e)}else if("y"==e[o][l]){const e=document.createElement("div");e.classList.add("blocked"),e.dataset.row=o,e.dataset.column=l,t.appendChild(e)}else{const e=document.createElement("div");e.classList.add("gameField"),e.dataset.row=o,e.dataset.column=l,t.appendChild(e)}},t=e=>{const t=document.querySelector(".ships");t.textContent="";for(let o=0;o<e.length;o++)if(1==e[o].land);else{const l=document.createElement("div");l.classList.add("ship"),l.dataset.id=e[o].id,l.classList.add(e[o].name),l.style.gridTemplateColumns=`repeat(${e[o].size}, 1fr)`,l.style.width=`calc(${e[o].id} * 50px)`,l.style.height="50px",l.style.backgroundColor="black",l.draggable=!0;for(let t=0;t<e[o].size;t++){const e=document.createElement("div");e.classList.add("square"),l.appendChild(e)}t.appendChild(l)}},o=e=>{const t=document.querySelector(".computerGameBoard");t.textContent="";for(let o=0;o<10;o++)for(let l=0;l<10;l++)if("X"==e[o][l]){const e=document.createElement("div");e.classList.add("plays"),e.dataset.row=o,e.dataset.column=l,t.appendChild(e)}else{const e=document.createElement("div");e.classList.add("field"),e.dataset.row=o,e.dataset.column=l,t.appendChild(e)}},l=()=>({rowChoice:Math.floor(9*Math.random()),columnChoice:Math.floor(99*Math.random())}),n=[];let s=0;for(let e=0;e<10;e++){const e=[];for(let t=0;t<10;t++)e.push(s),s++;n.push(e)}const a=[{name:"Destroyer",size:2,id:2,land:!1,position:[]},{name:"Submarine",size:3,id:3,land:!1,position:[]},{name:"Cruiser",size:3,id:3,land:!1,position:[]},{name:"Battleship",size:4,id:4,land:!1,position:[]},{name:"Carrier",size:5,id:5,land:!1,position:[]}],i=[{name:"Destroyer",size:2,id:2,land:!1,position:[]},{name:"Submarine",size:3,id:3,land:!1,position:[]},{name:"Cruiser",size:3,id:3,land:!1,position:[]},{name:"Battleship",size:4,id:4,land:!1,position:[]},{name:"Carrier",size:5,id:5,land:!1,position:[]}],r=e=>"X"!==e;let d,c=[];for(let e=0;e<10;e++){const e=[];for(let t=0;t<10;t++)e.push(s),s++;c.push(e)}(()=>{l().rowChoice,l().columnChoice,c.length=0;let e=0;for(let t=0;t<10;t++){const t=[];for(let o=0;o<10;o++)t.push(e),e++;c.push(t)}let t=0;o(c);for(let o=0;o<1e3;o++){for(let e=0;e<i.length;e++)i[e].position.every(r)||(i[e].position.length=0);if(i[0].position.length&&i[1].position.length&&i[2].position.length&&i[3].position.length&&i[4].position.length){for(let e=0;e<10;e++)c[e].filter((e=>"X"==e))&&(t+=c[e].filter((e=>"X"==e)).length);if(console.log(t),17!=t){c.length=0;for(let t=0;t<10;t++){const t=[];for(let o=0;o<10;o++)t.push(e),e++;c.push(t)}for(let e=0;e<5;e++)i[e].position.length=0;break}return{computerArr:c,shipNameAndSizeComputer:i}}for(let e=0;e<i.length;e++)if(i[e].position.length>1);else{const t=(n=e,Math.floor(94*Math.random())+i[n].size);let o,l;1==t.toString().length?(o=0,l=Number(t.toString().split("")[0])):(o=Number(t.toString().split("")[0]),l=Number(t.toString().split("")[1]));const s=c[o].findIndex((e=>e==t));if(s>0&&s-i[e].size>=0)for(let t=0;t<i[e].size;t++)i[e].position.push(c[o][s-t]),c[o][s-t]="X"}}var n})(),o(c),e(n),t(a),document.addEventListener("dragstart",(e=>{d=e.target,e.target.style.opacity=.3}),!1),document.addEventListener("dragend",(e=>{e.target.style.opacity="",e.target.dataset.row=e.target.firstChild.dataset.row,e.target.dataset.column=e.target.firstChild.dataset.column}),!1),document.addEventListener("dragover",(e=>{e.preventDefault()}),!1),document.addEventListener("dragenter",(e=>{"gameField"==e.target.className&&(e.target.style.background="yellow")}),!1),document.addEventListener("dragleave",(e=>{"gameField"==e.target.className&&(e.target.style.background="")}),!1),document.addEventListener("drop",(o=>{if(o.preventDefault(),"gameField"==o.target.className){o.target.style.background="",o.target.appendChild(d);let l=!1,s=o.target.dataset.row+o.target.dataset.column,i=Number(s);for(let e=0;e<s.split("").length;e++)0==s.split("")[0]&&(s=s.split("")[1]);const r=o.target.firstChild.className.split(" ")[1];let c,p;for(let e=0;e<a.length;e++)a[e].name==r&&(c=a[e].size,p=e);const g=i,m=i+c-1,u=[];for(let e=g;e<=m;e++)u.push(e);const h=(e,t,o,l)=>{for(let l=0;l<e.length;l++)if(e[l].includes(t))return!!e[l].includes(o)&&(!0,a[p].land=!0,true)};if(t(a),h(n,g,m,l)){o.target.style.background="",d.parentNode.removeChild(d),o.target.appendChild(d);for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)if(n[e][t]==g)if(0==n[e][t]){for(let o=0;o<c;o++)a[p].position.push(n[e][t+o]),n[e][t+o]="x";n[e+1][t]="y";for(let o=0;o<c;o++)n[e+1][t+o]="y";n[e][t+c]="y",console.log(e)}else if(n[e][t]==n[0][t]){for(let o=0;o<c;o++)a[p].position.push(n[e][t+o]),n[e][t+o]="x";n[e+1][t]="y";for(let o=0;o<c;o++)n[e+1][t+o]="y";n[e][g-1]="y",n[e][m+1]="y"}else if(n[e][t]==n[9][t]&&0!=t){for(let o=0;o<c;o++)a[p].position.push(n[e][t+o]),n[e][t+o]="x";for(let o=0;o<c;o++)n[e-1][t+o]="y";console.log(!0,!1),n[e][c+t]="y",n[e][t-1]="y"}else if(n[e][t]==n[9][t]){for(let o=0;o<c;o++)a[p].position.push(n[e][t+o]),n[e][t+o]="x";for(let o=0;o<c;o++)n[e-1][t+o]="y";console.log(!0,!1),n[e][c]="y"}else{for(let o=0;o<c;o++)a[p].position.push(n[e][t+o]),n[e][t+o]="x";n[e+1][t]="y",n[e-1][t]="y",n[e][t-1]="y",n[e][t+c]="y";for(let o=0;o<c;o++)n[e+1][t+o]="y",n[e-1][t+o]="y"}d.parentNode.removeChild(d)}else d.parentNode.removeChild(d),o.target.style.background="",t(a),a[p].land=!1,e(n);t(a)}(e=>{let t=0;for(let o=0;o<e.length;o++)e[o].position.length&&t++;return 5==t})(a)&&console.log("start game"),e(n),console.log(n),console.log(a)}),!1)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFpQ0EsRUFqQ3lCQSxJQUNyQixNQUFNQyxFQUFpQkMsU0FBU0MsY0FBYyxjQUU5Q0YsRUFBZUcsWUFBYyxHQUU3QixJQUFJLElBQUlDLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxJQUNuQixJQUFJLElBQUlDLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxJQUNuQixHQUEwQixLQUF2Qk4sRUFBY0ssR0FBR0MsR0FBVSxDQUMxQixNQUFNQyxFQUFZTCxTQUFTTSxjQUFjLE9BQ3pDRCxFQUFVRSxVQUFVQyxJQUFJLFdBQ3hCSCxFQUFVSSxRQUFRQyxJQUFNUCxFQUN4QkUsRUFBVUksUUFBUUUsT0FBU1AsRUFFM0JMLEVBQWVhLFlBQVlQLFFBQ3pCLEdBQTBCLEtBQXZCUCxFQUFjSyxHQUFHQyxHQUFVLENBQ2hDLE1BQU1DLEVBQVlMLFNBQVNNLGNBQWMsT0FDekNELEVBQVVFLFVBQVVDLElBQUksV0FDeEJILEVBQVVJLFFBQVFDLElBQU1QLEVBQ3hCRSxFQUFVSSxRQUFRRSxPQUFTUCxFQUUzQkwsRUFBZWEsWUFBWVAsT0FDMUIsQ0FDRCxNQUFNQSxFQUFZTCxTQUFTTSxjQUFjLE9BQ3pDRCxFQUFVRSxVQUFVQyxJQUFJLGFBQ3hCSCxFQUFVSSxRQUFRQyxJQUFNUCxFQUN4QkUsRUFBVUksUUFBUUUsT0FBU1AsRUFFM0JMLEVBQWVhLFlBQVlQLEtDSzNDLEVBaENvQlEsSUFDaEIsTUFBTUMsRUFBYWQsU0FBU0MsY0FBYyxVQUUxQ2EsRUFBV1osWUFBYyxHQUV6QixJQUFJLElBQUlDLEVBQUksRUFBR0EsRUFBSVUsRUFBZ0JFLE9BQVFaLElBQ3ZDLEdBQThCLEdBQTNCVSxFQUFnQlYsR0FBR2EsVUFFakIsQ0FDRCxNQUFNQyxFQUFPakIsU0FBU00sY0FBYyxPQUNwQ1csRUFBS1YsVUFBVUMsSUFBSSxRQUNuQlMsRUFBS1IsUUFBUVMsR0FBS0wsRUFBZ0JWLEdBQUdlLEdBQ3JDRCxFQUFLVixVQUFVQyxJQUFJSyxFQUFnQlYsR0FBR2dCLE1BQ3RDRixFQUFLRyxNQUFNQyxvQkFBc0IsVUFBVVIsRUFBZ0JWLEdBQUdtQixhQUM5REwsRUFBS0csTUFBTUcsTUFBUSxRQUFRVixFQUFnQlYsR0FBR2UsYUFDOUNELEVBQUtHLE1BQU1JLE9BQVMsT0FDcEJQLEVBQUtHLE1BQU1LLGdCQUFrQixRQUM3QlIsRUFBS1MsV0FBWSxFQUdqQixJQUFJLElBQUl0QixFQUFJLEVBQUdBLEVBQUlTLEVBQWdCVixHQUFHbUIsS0FBTWxCLElBQUksQ0FDNUMsTUFBTXVCLEVBQVMzQixTQUFTTSxjQUFjLE9BQ3RDcUIsRUFBT3BCLFVBQVVDLElBQUksVUFFckJTLEVBQUtMLFlBQVllLEdBR3JCYixFQUFXRixZQUFZSyxLQ0RuQyxFQTFCZ0NXLElBRTVCLE1BQU1DLEVBQW9CN0IsU0FBU0MsY0FBYyxzQkFDakQ0QixFQUFrQjNCLFlBQWMsR0FFaEMsSUFBSSxJQUFJQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDbkIsSUFBSSxJQUFJQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDbkIsR0FBd0IsS0FBckJ3QixFQUFZekIsR0FBR0MsR0FBVSxDQUN4QixNQUFNQyxFQUFZTCxTQUFTTSxjQUFjLE9BQ3pDRCxFQUFVRSxVQUFVQyxJQUFJLFNBQ3hCSCxFQUFVSSxRQUFRQyxJQUFNUCxFQUN4QkUsRUFBVUksUUFBUUUsT0FBU1AsRUFFM0J5QixFQUFrQmpCLFlBQVlQLE9BQzdCLENBQ0QsTUFBTUEsRUFBWUwsU0FBU00sY0FBYyxPQUN6Q0QsRUFBVUUsVUFBVUMsSUFBSSxTQUN4QkgsRUFBVUksUUFBUUMsSUFBTVAsRUFDeEJFLEVBQVVJLFFBQVFFLE9BQVNQLEVBRTNCeUIsRUFBa0JqQixZQUFZUCxLQ1Y5QyxFQVZzQixLQUlaLENBQ0Z5QixVQUpjQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFLOUJDLGFBSmlCSCxLQUFLQyxNQUFzQixHQUFoQkQsS0FBS0UsWUNHbkNuQyxFQUFnQixHQUN0QixJQUFJcUMsRUFBUSxFQUVaLElBQUksSUFBSWhDLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxJQUFJLENBQ3ZCLE1BQU1pQyxFQUFTLEdBRWYsSUFBSSxJQUFJaEMsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQ25CZ0MsRUFBT0MsS0FBS0YsR0FDWkEsSUFFSnJDLEVBQWN1QyxLQUFLRCxHQUd2QixNQUFNdkIsRUFBa0IsQ0FDcEIsQ0FBQ00sS0FBTSxZQUFhRyxLQUFNLEVBQUdKLEdBQUksRUFBR0YsTUFBTSxFQUFPc0IsU0FBVSxJQUMzRCxDQUFDbkIsS0FBTSxZQUFhRyxLQUFNLEVBQUdKLEdBQUksRUFBR0YsTUFBTSxFQUFPc0IsU0FBVSxJQUMzRCxDQUFDbkIsS0FBTSxVQUFXRyxLQUFNLEVBQUdKLEdBQUksRUFBR0YsTUFBTSxFQUFPc0IsU0FBVSxJQUN6RCxDQUFDbkIsS0FBTSxhQUFjRyxLQUFNLEVBQUdKLEdBQUksRUFBR0YsTUFBTSxFQUFPc0IsU0FBVSxJQUM1RCxDQUFDbkIsS0FBTSxVQUFXRyxLQUFNLEVBQUdKLEdBQUksRUFBR0YsTUFBTSxFQUFPc0IsU0FBVSxLQUd2REMsRUFBMEIsQ0FDNUIsQ0FBQ3BCLEtBQU0sWUFBYUcsS0FBTSxFQUFHSixHQUFJLEVBQUdGLE1BQU0sRUFBT3NCLFNBQVUsSUFDM0QsQ0FBQ25CLEtBQU0sWUFBYUcsS0FBTSxFQUFHSixHQUFJLEVBQUdGLE1BQU0sRUFBT3NCLFNBQVUsSUFDM0QsQ0FBQ25CLEtBQU0sVUFBV0csS0FBTSxFQUFHSixHQUFJLEVBQUdGLE1BQU0sRUFBT3NCLFNBQVUsSUFDekQsQ0FBQ25CLEtBQU0sYUFBY0csS0FBTSxFQUFHSixHQUFJLEVBQUdGLE1BQU0sRUFBT3NCLFNBQVUsSUFDNUQsQ0FBQ25CLEtBQU0sVUFBV0csS0FBTSxFQUFHSixHQUFJLEVBQUdGLE1BQU0sRUFBT3NCLFNBQVUsS0FHdkRFLEVBQWVDLEdBQ0QsTUFBVEEsRUFPWCxJQTBJSUMsRUExSUFkLEVBQWMsR0FFbEIsSUFBSSxJQUFJekIsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQUksQ0FDdkIsTUFBTWlDLEVBQVMsR0FFZixJQUFJLElBQUloQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDbkJnQyxFQUFPQyxLQUFLRixHQUNaQSxJQUVKUCxFQUFZUyxLQUFLRCxHQUdKLE1BQ0QsSUFBZ0JOLFVBQ2IsSUFBZ0JJLGFBQy9CTixFQUFZYixPQUFTLEVBTXJCLElBQUlvQixFQUFRLEVBRVosSUFBSSxJQUFJaEMsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQUksQ0FDdkIsTUFBTWlDLEVBQVMsR0FFZixJQUFJLElBQUloQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDbkJnQyxFQUFPQyxLQUFLRixHQUNaQSxJQUVKUCxFQUFZUyxLQUFLRCxHQUdyQixJQUFJTyxFQUFXLEVBRWYsRUFBdUJmLEdBRXZCLElBQUksSUFBSWdCLEVBQUksRUFBR0EsRUFBSSxJQUFNQSxJQUFJLENBQ3pCLElBQUksSUFBSUMsRUFBSSxFQUFHQSxFQUFJTixFQUF3QnhCLE9BQVE4QixJQUM1Q04sRUFBd0JNLEdBQUdQLFNBQVNRLE1BQU1OLEtBR3pDRCxFQUF3Qk0sR0FBR1AsU0FBU3ZCLE9BQVMsR0FJckQsR0FBR3dCLEVBQXdCLEdBQUdELFNBQVN2QixRQUFVd0IsRUFBd0IsR0FBR0QsU0FBU3ZCLFFBQVV3QixFQUF3QixHQUFHRCxTQUFTdkIsUUFBVXdCLEVBQXdCLEdBQUdELFNBQVN2QixRQUFVd0IsRUFBd0IsR0FBR0QsU0FBU3ZCLE9BQU8sQ0FDbE8sSUFBSSxJQUFJZ0MsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQ2hCbkIsRUFBWW1CLEdBQUdDLFFBQU9QLEdBQWlCLEtBQVJBLE1BQzlCRSxHQUFZZixFQUFZbUIsR0FBR0MsUUFBT1AsR0FBZ0IsS0FBUkEsSUFBYTFCLFFBSy9ELEdBRkFrQyxRQUFRQyxJQUFJUCxHQUVHLElBQVpBLEVBRUUsQ0FDRGYsRUFBWWIsT0FBUyxFQUNyQixJQUFJLElBQUlaLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxJQUFJLENBQ3ZCLE1BQU1pQyxFQUFTLEdBRWYsSUFBSSxJQUFJaEMsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQ25CZ0MsRUFBT0MsS0FBS0YsR0FDWkEsSUFFSlAsRUFBWVMsS0FBS0QsR0FFckIsSUFBSSxJQUFJZSxFQUFJLEVBQUdBLEVBQUksRUFBR0EsSUFDbEJaLEVBQXdCWSxHQUFHYixTQUFTdkIsT0FBUyxFQUVqRCxNQUdKLE1BQU8sQ0FDSGEsWUFBQUEsRUFDQVcsd0JBQUFBLEdBR0osSUFBSSxJQUFJcEMsRUFBSSxFQUFHQSxFQUFJb0MsRUFBd0J4QixPQUFRWixJQUMvQyxHQUFHb0MsRUFBd0JwQyxHQUFHbUMsU0FBU3ZCLE9BQVMsT0FFM0MsQ0FDRCxNQUFNcUMsR0FqRUVDLEVBaUVxQmxELEVBaEVsQzRCLEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQUFpQk0sRUFBd0JjLEdBQUsvQixNQWlFekQsSUFBSVosRUFDQUMsRUFFc0IsR0FBM0J5QyxFQUFNRSxXQUFXdkMsUUFDaEJMLEVBQU0sRUFDTkMsRUFBUzRDLE9BQU9ILEVBQU1FLFdBQVdFLE1BQU0sSUFBSSxNQUUzQzlDLEVBQU02QyxPQUFPSCxFQUFNRSxXQUFXRSxNQUFNLElBQUksSUFDeEM3QyxFQUFTNEMsT0FBT0gsRUFBTUUsV0FBV0UsTUFBTSxJQUFJLEtBRy9DLE1BQU1DLEVBQW9CN0IsRUFBWWxCLEdBQUtnRCxXQUFVakIsR0FBUUEsR0FBUVcsSUFFckUsR0FBR0ssRUFBb0IsR0FDaEJBLEVBQW9CbEIsRUFBd0JwQyxHQUFHbUIsTUFBUSxFQUN0RCxJQUFJLElBQUlsQixFQUFJLEVBQUdBLEVBQUltQyxFQUF3QnBDLEdBQUdtQixLQUFNbEIsSUFDaERtQyxFQUF3QnBDLEdBQUdtQyxTQUFTRCxLQUFLVCxFQUFZbEIsR0FBSytDLEVBQW9CckQsSUFDOUV3QixFQUFZbEIsR0FBSytDLEVBQW9CckQsR0FBSyxLQW5GM0MsSUFBQ2lELEdBNEY1Qk0sR0FDQSxFQUF1Qi9CLEdBOEJ2QixFQUFnQjlCLEdBQ2hCLEVBQVdlLEdBRVhiLFNBQVM0RCxpQkFBaUIsYUFBY0MsSUFDcENuQixFQUFVbUIsRUFBRUMsT0FFWkQsRUFBRUMsT0FBTzFDLE1BQU0yQyxRQUFVLE1BRTFCLEdBRUgvRCxTQUFTNEQsaUJBQWlCLFdBQVlDLElBQ2xDQSxFQUFFQyxPQUFPMUMsTUFBTTJDLFFBQVUsR0FDekJGLEVBQUVDLE9BQU9yRCxRQUFRQyxJQUFNbUQsRUFBRUMsT0FBT0UsV0FBV3ZELFFBQVFDLElBQ25EbUQsRUFBRUMsT0FBT3JELFFBQVFFLE9BQVNrRCxFQUFFQyxPQUFPRSxXQUFXdkQsUUFBUUUsVUFDdkQsR0FFSFgsU0FBUzRELGlCQUFpQixZQUFhQyxJQUNuQ0EsRUFBRUksb0JBQ0gsR0FFSGpFLFNBQVM0RCxpQkFBaUIsYUFBY0MsSUFDWCxhQUF0QkEsRUFBRUMsT0FBT0ksWUFDUkwsRUFBRUMsT0FBTzFDLE1BQU0rQyxXQUFhLGFBRWpDLEdBRUhuRSxTQUFTNEQsaUJBQWlCLGFBQWNDLElBRVYsYUFBdEJBLEVBQUVDLE9BQU9JLFlBQ1RMLEVBQUVDLE9BQU8xQyxNQUFNK0MsV0FBYSxPQUVqQyxHQUVIbkUsU0FBUzRELGlCQUFpQixRQUFTQyxJQUcvQixHQUZBQSxFQUFFSSxpQkFFdUIsYUFBdEJKLEVBQUVDLE9BQU9JLFVBQXlCLENBQ2pDTCxFQUFFQyxPQUFPMUMsTUFBTStDLFdBQWEsR0FDNUJOLEVBQUVDLE9BQU9sRCxZQUFZOEIsR0FFckIsSUFBSTBCLEdBQWlCLEVBRWpCQyxFQUFpQlIsRUFBRUMsT0FBT3JELFFBQVFDLElBQU1tRCxFQUFFQyxPQUFPckQsUUFBUUUsT0FFekQyRCxFQUFjZixPQUFPYyxHQUV6QixJQUFJLElBQUlsRSxFQUFJLEVBQUdBLEVBQUlrRSxFQUFlYixNQUFNLElBQUl6QyxPQUFRWixJQUNkLEdBQS9Ca0UsRUFBZWIsTUFBTSxJQUFJLEtBQ3hCYSxFQUFpQkEsRUFBZWIsTUFBTSxJQUFJLElBSWxELE1BQU1lLEVBQVdWLEVBQUVDLE9BQU9FLFdBQVdFLFVBQVVWLE1BQU0sS0FBSyxHQUMxRCxJQUFJZ0IsRUFFQUMsRUFFSixJQUFJLElBQUlyRSxFQUFJLEVBQUdBLEVBQUlTLEVBQWdCRSxPQUFRWCxJQUNwQ1MsRUFBZ0JULEdBQUdlLE1BQVFvRCxJQUMxQkMsRUFBYTNELEVBQWdCVCxHQUFHa0IsS0FDaENtRCxFQUFXckUsR0FHbkIsTUFBTXNFLEVBQWdCSixFQUNoQkssRUFBbUJMLEVBQWNFLEVBQWEsRUFDOUNJLEVBQWtCLEdBRXhCLElBQUksSUFBSS9CLEVBQUk2QixFQUFlN0IsR0FBSzhCLEVBQWtCOUIsSUFDOUMrQixFQUFnQnZDLEtBQUtRLEdBR3pCLE1BQU1nQyxFQUFTLENBQUMvRSxFQUFlNEUsRUFBZUMsRUFBa0JQLEtBQzVELElBQUksSUFBSVUsRUFBSSxFQUFHQSxFQUFJaEYsRUFBY2lCLE9BQVErRCxJQUNyQyxHQUFHaEYsRUFBY2dGLEdBQUdDLFNBQVNMLEdBQ3pCLFFBQUc1RSxFQUFjZ0YsR0FBR0MsU0FBU0osTUFDUixFQUNqQjlELEVBQWdCNEQsR0FBVXpELE1BQU8sRUFEaEIsT0FhakMsR0FGQSxFQUFXSCxHQUVQZ0UsRUFBTy9FLEVBQWU0RSxFQUFlQyxFQUFrQlAsR0FPdEQsQ0FDRFAsRUFBRUMsT0FBTzFDLE1BQU0rQyxXQUFhLEdBQzVCekIsRUFBUXNDLFdBQVdDLFlBQVl2QyxHQUMvQm1CLEVBQUVDLE9BQU9sRCxZQUFZOEIsR0FFckIsSUFBSSxJQUFJdkMsRUFBSSxFQUFHQSxFQUFJTCxFQUFjaUIsT0FBUVosSUFDckMsSUFBSSxJQUFJQyxFQUFJLEVBQUdBLEVBQUlOLEVBQWNLLEdBQUdZLE9BQVFYLElBQ3hDLEdBQUdOLEVBQWNLLEdBQUdDLElBQU1zRSxFQUN0QixHQUEwQixHQUF2QjVFLEVBQWNLLEdBQUdDLEdBQVEsQ0FDeEIsSUFBSSxJQUFJOEUsRUFBSSxFQUFHQSxFQUFJVixFQUFZVSxJQUMzQnJFLEVBQWdCNEQsR0FBVW5DLFNBQVNELEtBQUt2QyxFQUFjSyxHQUFHQyxFQUFJOEUsSUFDN0RwRixFQUFjSyxHQUFHQyxFQUFJOEUsR0FBSyxJQUU5QnBGLEVBQWNLLEVBQUksR0FBR0MsR0FBSyxJQUMxQixJQUFJLElBQUkrRSxFQUFJLEVBQUdBLEVBQUlYLEVBQVlXLElBQzNCckYsRUFBY0ssRUFBSSxHQUFHQyxFQUFJK0UsR0FBSyxJQUVsQ3JGLEVBQWNLLEdBQUdDLEVBQUlvRSxHQUFjLElBRW5DdkIsUUFBUUMsSUFBSS9DLFFBQ1YsR0FBR0wsRUFBY0ssR0FBR0MsSUFBTU4sRUFBYyxHQUFHTSxHQUFHLENBQ2hELElBQUksSUFBSThFLEVBQUksRUFBR0EsRUFBSVYsRUFBWVUsSUFDM0JyRSxFQUFnQjRELEdBQVVuQyxTQUFTRCxLQUFLdkMsRUFBY0ssR0FBR0MsRUFBSThFLElBQzdEcEYsRUFBY0ssR0FBR0MsRUFBSThFLEdBQUssSUFFOUJwRixFQUFjSyxFQUFJLEdBQUdDLEdBQUssSUFDMUIsSUFBSSxJQUFJK0UsRUFBSSxFQUFHQSxFQUFJWCxFQUFZVyxJQUMzQnJGLEVBQWNLLEVBQUksR0FBR0MsRUFBSStFLEdBQUssSUFFbENyRixFQUFjSyxHQUFHdUUsRUFBZ0IsR0FBSyxJQUN0QzVFLEVBQWNLLEdBQUd3RSxFQUFtQixHQUFLLFNBQ3ZDLEdBQUc3RSxFQUFjSyxHQUFHQyxJQUFNTixFQUFjLEdBQUdNLElBQVcsR0FBTEEsRUFBTyxDQUMxRCxJQUFJLElBQUk4RSxFQUFJLEVBQUdBLEVBQUlWLEVBQVlVLElBQzNCckUsRUFBZ0I0RCxHQUFVbkMsU0FBU0QsS0FBS3ZDLEVBQWNLLEdBQUdDLEVBQUk4RSxJQUM3RHBGLEVBQWNLLEdBQUdDLEVBQUk4RSxHQUFLLElBRTlCLElBQUksSUFBSUMsRUFBSSxFQUFHQSxFQUFJWCxFQUFZVyxJQUMzQnJGLEVBQWNLLEVBQUksR0FBR0MsRUFBSStFLEdBQUssSUFFbENsQyxRQUFRQyxLQUFJLEdBQU0sR0FDbEJwRCxFQUFjSyxHQUFHcUUsRUFBYXBFLEdBQUssSUFDbkNOLEVBQWNLLEdBQUdDLEVBQUksR0FBSyxTQUN4QixHQUFHTixFQUFjSyxHQUFHQyxJQUFNTixFQUFjLEdBQUdNLEdBQUcsQ0FDaEQsSUFBSSxJQUFJOEUsRUFBSSxFQUFHQSxFQUFJVixFQUFZVSxJQUMzQnJFLEVBQWdCNEQsR0FBVW5DLFNBQVNELEtBQUt2QyxFQUFjSyxHQUFHQyxFQUFJOEUsSUFDN0RwRixFQUFjSyxHQUFHQyxFQUFJOEUsR0FBSyxJQUU5QixJQUFJLElBQUlDLEVBQUksRUFBR0EsRUFBSVgsRUFBWVcsSUFDM0JyRixFQUFjSyxFQUFJLEdBQUdDLEVBQUkrRSxHQUFLLElBRWxDbEMsUUFBUUMsS0FBSSxHQUFNLEdBQ2xCcEQsRUFBY0ssR0FBR3FFLEdBQWMsUUFDOUIsQ0FDRCxJQUFJLElBQUlVLEVBQUksRUFBR0EsRUFBSVYsRUFBWVUsSUFDM0JyRSxFQUFnQjRELEdBQVVuQyxTQUFTRCxLQUFLdkMsRUFBY0ssR0FBR0MsRUFBSThFLElBQzdEcEYsRUFBY0ssR0FBR0MsRUFBSThFLEdBQUssSUFFOUJwRixFQUFjSyxFQUFJLEdBQUdDLEdBQUssSUFDMUJOLEVBQWNLLEVBQUksR0FBR0MsR0FBSyxJQUMxQk4sRUFBY0ssR0FBR0MsRUFBSSxHQUFLLElBQzFCTixFQUFjSyxHQUFHQyxFQUFJb0UsR0FBYyxJQUNuQyxJQUFJLElBQUlXLEVBQUksRUFBR0EsRUFBSVgsRUFBWVcsSUFDM0JyRixFQUFjSyxFQUFJLEdBQUdDLEVBQUkrRSxHQUFLLElBQzlCckYsRUFBY0ssRUFBSSxHQUFHQyxFQUFJK0UsR0FBSyxJQU1sRHpDLEVBQVFzQyxXQUFXQyxZQUFZdkMsUUEzRS9CQSxFQUFRc0MsV0FBV0MsWUFBWXZDLEdBQy9CbUIsRUFBRUMsT0FBTzFDLE1BQU0rQyxXQUFhLEdBQzVCLEVBQVd0RCxHQUNYQSxFQUFnQjRELEdBQVV6RCxNQUFPLEVBRWpDLEVBQWdCbEIsR0F3RXBCLEVBQVdlLEdBR1EsQ0FBQ0EsSUFDcEIsSUFBSXNCLEVBQVEsRUFDWixJQUFJLElBQUloQyxFQUFJLEVBQUdBLEVBQUlVLEVBQWdCRSxPQUFRWixJQUNwQ1UsRUFBZ0JWLEdBQUdtQyxTQUFTdkIsUUFDM0JvQixJQUlSLE9BQVksR0FBVEEsR0FPSmlELENBQWV2RSxJQUNkb0MsUUFBUUMsSUFBSSxjQUdoQixFQUFnQnBELEdBRWhCbUQsUUFBUUMsSUFBSXBELEdBQ1ptRCxRQUFRQyxJQUFJckMsTUFDYixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9jb21wb25lbnRzL2dhbWVCb2FyZEZpZWxkcy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2NvbXBvbmVudHMvY3JlYXRlU2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2NvbXBvbmVudHMvY29tcHV0ZXJHYW1lQm9hcmRGaWVsZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2NvbXBvbmVudHMvY29tcHV0ZXJDaG9pY2UuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYW1lQm9hcmRGaWVsZHMgPSAoZ2FtZUZpZWxkc0FycikgPT4ge1xyXG4gICAgY29uc3QgZ2FtZUJvYXJkQ2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZWJvYXJkJyk7XHJcblxyXG4gICAgZ2FtZUJvYXJkQ2xhc3MudGV4dENvbnRlbnQgPSAnJztcclxuXHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKyl7XHJcbiAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspe1xyXG4gICAgICAgICAgICBpZihnYW1lRmllbGRzQXJyW2ldW2pdID09ICd4Jyl7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnYW1lRmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuZGF0YXNldC5yb3cgPSBpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQuY29sdW1uID0gajtcclxuXHJcbiAgICAgICAgICAgICAgICBnYW1lQm9hcmRDbGFzcy5hcHBlbmRDaGlsZChnYW1lRmllbGQpO1xyXG4gICAgICAgICAgICB9ZWxzZSBpZihnYW1lRmllbGRzQXJyW2ldW2pdID09ICd5Jyl7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnYW1lRmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5jbGFzc0xpc3QuYWRkKCdibG9ja2VkJyk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuZGF0YXNldC5yb3cgPSBpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQuY29sdW1uID0gajtcclxuXHJcbiAgICAgICAgICAgICAgICBnYW1lQm9hcmRDbGFzcy5hcHBlbmRDaGlsZChnYW1lRmllbGQpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGdhbWVGaWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmNsYXNzTGlzdC5hZGQoJ2dhbWVGaWVsZCcpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQucm93ID0gaTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5kYXRhc2V0LmNvbHVtbiA9IGo7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGdhbWVCb2FyZENsYXNzLmFwcGVuZENoaWxkKGdhbWVGaWVsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGdhbWVCb2FyZEZpZWxkczsiLCJjb25zdCBjcmVhdGVTaGlwID0gKHNoaXBOYW1lQW5kU2l6ZSkgPT4ge1xyXG4gICAgY29uc3Qgc2hpcHNDbGFzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaGlwcycpO1xyXG5cclxuICAgIHNoaXBzQ2xhc3MudGV4dENvbnRlbnQgPSAnJztcclxuXHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2hpcE5hbWVBbmRTaXplLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICBpZihzaGlwTmFtZUFuZFNpemVbaV0ubGFuZCA9PSB0cnVlKXtcclxuXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoaXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgc2hpcC5jbGFzc0xpc3QuYWRkKCdzaGlwJyk7XHJcbiAgICAgICAgICAgIHNoaXAuZGF0YXNldC5pZCA9IHNoaXBOYW1lQW5kU2l6ZVtpXS5pZDtcclxuICAgICAgICAgICAgc2hpcC5jbGFzc0xpc3QuYWRkKHNoaXBOYW1lQW5kU2l6ZVtpXS5uYW1lKTtcclxuICAgICAgICAgICAgc2hpcC5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdCgke3NoaXBOYW1lQW5kU2l6ZVtpXS5zaXplfSwgMWZyKWA7XHJcbiAgICAgICAgICAgIHNoaXAuc3R5bGUud2lkdGggPSBgY2FsYygke3NoaXBOYW1lQW5kU2l6ZVtpXS5pZH0gKiA1MHB4KWA7XHJcbiAgICAgICAgICAgIHNoaXAuc3R5bGUuaGVpZ2h0ID0gJzUwcHgnO1xyXG4gICAgICAgICAgICBzaGlwLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdibGFjayc7IFxyXG4gICAgICAgICAgICBzaGlwLmRyYWdnYWJsZSA9IHRydWU7XHJcblxyXG5cclxuICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHNoaXBOYW1lQW5kU2l6ZVtpXS5zaXplOyBqKyspe1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZCgnc3F1YXJlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2hpcC5hcHBlbmRDaGlsZChzcXVhcmUpO1xyXG4gICAgICAgICAgICB9ICAgXHJcblxyXG4gICAgICAgICAgICBzaGlwc0NsYXNzLmFwcGVuZENoaWxkKHNoaXApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlU2hpcDsiLCJjb25zdCBjb21wdXRlckdhbWVCb2FyZEZpZWxkID0gKGNvbXB1dGVyQXJyKSA9PiB7XHJcbiAgICBcclxuICAgIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXB1dGVyR2FtZUJvYXJkJyk7XHJcbiAgICBjb21wdXRlckdhbWVib2FyZC50ZXh0Q29udGVudCA9ICcnO1xyXG5cclxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKXtcclxuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICAgICAgICAgIGlmKGNvbXB1dGVyQXJyW2ldW2pdID09ICdYJyl7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnYW1lRmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5jbGFzc0xpc3QuYWRkKCdwbGF5cycpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQucm93ID0gaTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5kYXRhc2V0LmNvbHVtbiA9IGo7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLmFwcGVuZENoaWxkKGdhbWVGaWVsZCk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ2FtZUZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuY2xhc3NMaXN0LmFkZCgnZmllbGQnKTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5kYXRhc2V0LnJvdyA9IGk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuZGF0YXNldC5jb2x1bW4gPSBqO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb21wdXRlckdhbWVib2FyZC5hcHBlbmRDaGlsZChnYW1lRmllbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjb21wdXRlckdhbWVCb2FyZEZpZWxkOyIsImNvbnN0IGNvbXB0ZXJDaG9pY2UgPSAoKSA9PiB7XHJcbiAgICBjb25zdCByb3dDaG9pY2UgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA5KTtcclxuICAgIGNvbnN0IGNvbHVtbkNob2ljZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDk5KTtcclxuXHJcbiAgICByZXR1cm57XHJcbiAgICAgICAgcm93Q2hvaWNlLFxyXG4gICAgICAgIGNvbHVtbkNob2ljZSxcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY29tcHRlckNob2ljZTsiLCJpbXBvcnQgZ2FtZUJvYXJkRmllbGRzIGZyb20gXCIuL2NvbXBvbmVudHMvZ2FtZUJvYXJkRmllbGRzXCI7XHJcbmltcG9ydCBjcmVhdGVTaGlwIGZyb20gXCIuL2NvbXBvbmVudHMvY3JlYXRlU2hpcFwiO1xyXG5pbXBvcnQgY29tcHV0ZXJHYW1lQm9hcmRGaWVsZCBmcm9tIFwiLi9jb21wb25lbnRzL2NvbXB1dGVyR2FtZUJvYXJkRmllbGRcIjtcclxuaW1wb3J0IGNvbXB0ZXJDaG9pY2UgZnJvbSAnLi9jb21wb25lbnRzL2NvbXB1dGVyQ2hvaWNlJztcclxuXHJcbmNvbnN0IGdhbWVGaWVsZHNBcnIgPSBbXTtcclxubGV0IGNvdW50ID0gMDtcclxuXHJcbmZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKXtcclxuICAgIGNvbnN0IG5ld0FyciA9IFtdO1xyXG5cclxuICAgIGZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKXtcclxuICAgICAgICBuZXdBcnIucHVzaChjb3VudCk7XHJcbiAgICAgICAgY291bnQrKztcclxuICAgIH1cclxuICAgIGdhbWVGaWVsZHNBcnIucHVzaChuZXdBcnIpO1xyXG59XHJcblxyXG5jb25zdCBzaGlwTmFtZUFuZFNpemUgPSBbXHJcbiAgICB7bmFtZTogJ0Rlc3Ryb3llcicsIHNpemU6IDIsIGlkOiAyLCBsYW5kOiBmYWxzZSwgcG9zaXRpb246IFtdfSxcclxuICAgIHtuYW1lOiAnU3VibWFyaW5lJywgc2l6ZTogMywgaWQ6IDMsIGxhbmQ6IGZhbHNlLCBwb3NpdGlvbjogW119LFxyXG4gICAge25hbWU6ICdDcnVpc2VyJywgc2l6ZTogMywgaWQ6IDMsIGxhbmQ6IGZhbHNlLCBwb3NpdGlvbjogW119LFxyXG4gICAge25hbWU6ICdCYXR0bGVzaGlwJywgc2l6ZTogNCwgaWQ6IDQsIGxhbmQ6IGZhbHNlLCBwb3NpdGlvbjogW119LFxyXG4gICAge25hbWU6ICdDYXJyaWVyJywgc2l6ZTogNSwgaWQ6IDUsIGxhbmQ6IGZhbHNlLCBwb3NpdGlvbjogW119LFxyXG5dXHJcblxyXG5jb25zdCBzaGlwTmFtZUFuZFNpemVDb21wdXRlciA9IFtcclxuICAgIHtuYW1lOiAnRGVzdHJveWVyJywgc2l6ZTogMiwgaWQ6IDIsIGxhbmQ6IGZhbHNlLCBwb3NpdGlvbjogW119LFxyXG4gICAge25hbWU6ICdTdWJtYXJpbmUnLCBzaXplOiAzLCBpZDogMywgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICB7bmFtZTogJ0NydWlzZXInLCBzaXplOiAzLCBpZDogMywgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICB7bmFtZTogJ0JhdHRsZXNoaXAnLCBzaXplOiA0LCBpZDogNCwgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICB7bmFtZTogJ0NhcnJpZXInLCBzaXplOiA1LCBpZDogNSwgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbl1cclxuXHJcbmNvbnN0IHRydWVPckZhbHNlID0gKGl0ZW0pID0+IHtcclxuICAgIHJldHVybiBpdGVtICE9PSAnWCc7XHJcbn1cclxuXHJcbmNvbnN0IHRydWVPckZhbHNlVHdvID0gKGl0ZW0pID0+IHtcclxuICAgIHJldHVybiBpdGVtID09ICdYJztcclxufVxyXG5cclxubGV0IGNvbXB1dGVyQXJyID0gW107XHJcblxyXG5mb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKyl7XHJcbiAgICBjb25zdCBuZXdBcnIgPSBbXTtcclxuXHJcbiAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICAgICAgbmV3QXJyLnB1c2goY291bnQpO1xyXG4gICAgICAgIGNvdW50Kys7XHJcbiAgICB9XHJcbiAgICBjb21wdXRlckFyci5wdXNoKG5ld0Fycik7XHJcbn1cclxuXHJcbmNvbnN0IGNvbXB1dGVyID0gKCkgPT4ge1xyXG4gICAgY29uc3Qgcm93ID0gY29tcHRlckNob2ljZSgpLnJvd0Nob2ljZTtcclxuICAgIGNvbnN0IGNvbHVtbiA9IGNvbXB0ZXJDaG9pY2UoKS5jb2x1bW5DaG9pY2U7XHJcbiAgICBjb21wdXRlckFyci5sZW5ndGggPSAwO1xyXG5cclxuICAgIGNvbnN0IHJhbmRvbVBvc2l0aW9uID0gKG51bSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA5NCkgKyBzaGlwTmFtZUFuZFNpemVDb21wdXRlcltudW1dLnNpemU7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGNvdW50ID0gMDtcclxuXHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKyl7XHJcbiAgICAgICAgY29uc3QgbmV3QXJyID0gW107XHJcbiAgICBcclxuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICAgICAgICAgIG5ld0Fyci5wdXNoKGNvdW50KTtcclxuICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgY29tcHV0ZXJBcnIucHVzaChuZXdBcnIpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBjb3VudEFyciA9IDA7XHJcblxyXG4gICAgY29tcHV0ZXJHYW1lQm9hcmRGaWVsZChjb21wdXRlckFycik7XHJcblxyXG4gICAgZm9yKGxldCBiID0gMDsgYiA8IDEwMDA7IGIrKyl7XHJcbiAgICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IHNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyLmxlbmd0aDsgeCsrKXtcclxuICAgICAgICAgICAgaWYoc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXJbeF0ucG9zaXRpb24uZXZlcnkodHJ1ZU9yRmFsc2UpKXtcclxuXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXJbeF0ucG9zaXRpb24ubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXJbMF0ucG9zaXRpb24ubGVuZ3RoICYmIHNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyWzFdLnBvc2l0aW9uLmxlbmd0aCAmJiBzaGlwTmFtZUFuZFNpemVDb21wdXRlclsyXS5wb3NpdGlvbi5sZW5ndGggJiYgc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXJbM10ucG9zaXRpb24ubGVuZ3RoICYmIHNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyWzRdLnBvc2l0aW9uLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIGZvcihsZXQgbyA9IDA7IG8gPCAxMDsgbysrKXtcclxuICAgICAgICAgICAgICAgIGlmKGNvbXB1dGVyQXJyW29dLmZpbHRlcihpdGVtID0+ICBpdGVtID09ICdYJykpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50QXJyICs9IGNvbXB1dGVyQXJyW29dLmZpbHRlcihpdGVtID0+IGl0ZW0gPT0gJ1gnKS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvdW50QXJyKTtcclxuXHJcbiAgICAgICAgICAgIGlmKGNvdW50QXJyID09IDE3KXtcclxuXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgY29tcHV0ZXJBcnIubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdBcnIgPSBbXTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3QXJyLnB1c2goY291bnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFyci5wdXNoKG5ld0Fycik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IHEgPSAwOyBxIDwgNTsgcSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVDb21wdXRlcltxXS5wb3NpdGlvbi5sZW5ndGggPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBjb21wdXRlckFycixcclxuICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXIubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYoc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXJbaV0ucG9zaXRpb24ubGVuZ3RoID4gMSl7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmFuZG9tUG9zaXRpb24oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJvdztcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY29sdW1uO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYodmFsdWUudG9TdHJpbmcoKS5sZW5ndGggPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBOdW1iZXIodmFsdWUudG9TdHJpbmcoKS5zcGxpdCgnJylbMF0pO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gTnVtYmVyKHZhbHVlLnRvU3RyaW5nKCkuc3BsaXQoJycpWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBOdW1iZXIodmFsdWUudG9TdHJpbmcoKS5zcGxpdCgnJylbMV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmluZEluZGV4Q29tcHV0ZXIgPSBjb21wdXRlckFycltyb3ddLmZpbmRJbmRleChpdGVtID0+IGl0ZW0gPT0gdmFsdWUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYoZmluZEluZGV4Q29tcHV0ZXIgPiAwKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihmaW5kSW5kZXhDb21wdXRlciAtIHNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyW2ldLnNpemUgPj0gMCl7ICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXJbaV0uc2l6ZTsgaisrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyW2ldLnBvc2l0aW9uLnB1c2goY29tcHV0ZXJBcnJbcm93XVtmaW5kSW5kZXhDb21wdXRlciAtIGpdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW3Jvd11bZmluZEluZGV4Q29tcHV0ZXIgLSBqXSA9ICdYJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5jb21wdXRlcigpO1xyXG5jb21wdXRlckdhbWVCb2FyZEZpZWxkKGNvbXB1dGVyQXJyKTtcclxuXHJcbmNvbnN0IHNoaXAgPSAoYm9keUxlbmd0aCwgd2hlcmVIaXRzLCBzdW5rKSA9PiB7XHJcbiAgICBcclxuICAgIHJldHVybntcclxuICAgICAgICBib2R5TGVuZ3RoLFxyXG4gICAgICAgIHdoZXJlSGl0cyxcclxuICAgICAgICBzdW5rLFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBoaXQgPSAoaGl0UG9zaXRpb24pID0+IHtcclxuICAgIFxyXG4gICAgcmV0dXJue1xyXG4gICAgICAgIGhpdFBvc2l0aW9uLFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBpc1N1bmsgPSAoYm9keUxlbmd0aCkgPT4ge1xyXG4gICAgY29uc3QgaGl0cyA9IGJvZHlMZW5ndGggLSBzaGlwKCkuc3VuaztcclxuXHJcbiAgICBpZihoaXRzID09IDApe1xyXG4gICAgICAgIHJldHVybiAnc2hpcCBpcyBzdW5rJztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaGl0cztcclxufVxyXG5cclxubGV0IGRyYWdnZWQ7XHJcblxyXG5nYW1lQm9hcmRGaWVsZHMoZ2FtZUZpZWxkc0Fycik7XHJcbmNyZWF0ZVNoaXAoc2hpcE5hbWVBbmRTaXplKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGUpID0+IHtcclxuICAgIGRyYWdnZWQgPSBlLnRhcmdldDtcclxuXHJcbiAgICBlLnRhcmdldC5zdHlsZS5vcGFjaXR5ID0gLjM7XHJcblxyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuc3R5bGUub3BhY2l0eSA9IFwiXCI7XHJcbiAgICBlLnRhcmdldC5kYXRhc2V0LnJvdyA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuZGF0YXNldC5yb3c7XHJcbiAgICBlLnRhcmdldC5kYXRhc2V0LmNvbHVtbiA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuZGF0YXNldC5jb2x1bW47XHJcbn0sIGZhbHNlKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VudGVyXCIsIChlKSA9PiB7XHJcbiAgICBpZihlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJnYW1lRmllbGRcIil7XHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwieWVsbG93XCI7XHJcbiAgICB9XHJcbn0sIGZhbHNlKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgKGUpID0+IHtcclxuXHJcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NOYW1lID09IFwiZ2FtZUZpZWxkXCIpe1xyXG4gICAgICAgIGUudGFyZ2V0LnN0eWxlLmJhY2tncm91bmQgPSBcIlwiO1xyXG4gICAgfVxyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSAnZ2FtZUZpZWxkJyl7XHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCI7XHJcbiAgICAgICAgZS50YXJnZXQuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7XHJcblxyXG4gICAgICAgIGxldCBzaGlwSXNHb29kU2l6ZSA9IGZhbHNlO1xyXG4gXHJcbiAgICAgICAgbGV0IHJlc3VsdFBvc2l0aW9uID0gZS50YXJnZXQuZGF0YXNldC5yb3cgKyBlLnRhcmdldC5kYXRhc2V0LmNvbHVtbjtcclxuXHJcbiAgICAgICAgbGV0IHN0cmluZ1RvSW50ID0gTnVtYmVyKHJlc3VsdFBvc2l0aW9uKTtcclxuICAgIFxyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCByZXN1bHRQb3NpdGlvbi5zcGxpdCgnJykubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBpZihyZXN1bHRQb3NpdGlvbi5zcGxpdCgnJylbMF0gPT0gMCl7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRQb3NpdGlvbiA9IHJlc3VsdFBvc2l0aW9uLnNwbGl0KCcnKVsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gICBcclxuXHJcbiAgICAgICAgY29uc3QgbmFtZVNoaXAgPSBlLnRhcmdldC5maXJzdENoaWxkLmNsYXNzTmFtZS5zcGxpdCgnICcpWzFdO1xyXG4gICAgICAgIGxldCBsZW5ndGhTaGlwO1xyXG5cclxuICAgICAgICBsZXQgaW5kZXhPYmo7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHNoaXBOYW1lQW5kU2l6ZS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgIGlmKHNoaXBOYW1lQW5kU2l6ZVtqXS5uYW1lID09IG5hbWVTaGlwKXtcclxuICAgICAgICAgICAgICAgIGxlbmd0aFNoaXAgPSBzaGlwTmFtZUFuZFNpemVbal0uc2l6ZTtcclxuICAgICAgICAgICAgICAgIGluZGV4T2JqID0galxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGZpcnN0UG9zaXRpb24gPSBzdHJpbmdUb0ludDtcclxuICAgICAgICBjb25zdCBsYXN0U2hpcFBvc2l0aW9uID0gc3RyaW5nVG9JbnQgKyBsZW5ndGhTaGlwIC0gMTtcclxuICAgICAgICBjb25zdCBzaGlwQXJyUG9zaXRpb24gPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKGxldCB4ID0gZmlyc3RQb3NpdGlvbjsgeCA8PSBsYXN0U2hpcFBvc2l0aW9uOyB4Kyspe1xyXG4gICAgICAgICAgICBzaGlwQXJyUG9zaXRpb24ucHVzaCh4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGlzVHJ1ZSA9IChnYW1lRmllbGRzQXJyLCBmaXJzdFBvc2l0aW9uLCBsYXN0U2hpcFBvc2l0aW9uLCBzaGlwSXNHb29kU2l6ZSkgPT4ge1xyXG4gICAgICAgICAgICBmb3IobGV0IG4gPSAwOyBuIDwgZ2FtZUZpZWxkc0Fyci5sZW5ndGg7IG4rKyl7XHJcbiAgICAgICAgICAgICAgICBpZihnYW1lRmllbGRzQXJyW25dLmluY2x1ZGVzKGZpcnN0UG9zaXRpb24pKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihnYW1lRmllbGRzQXJyW25dLmluY2x1ZGVzKGxhc3RTaGlwUG9zaXRpb24pKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hpcElzR29vZFNpemUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLmxhbmQgPSB0cnVlO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGlwSXNHb29kU2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICB9OyBcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGlwSXNHb29kU2l6ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjcmVhdGVTaGlwKHNoaXBOYW1lQW5kU2l6ZSk7XHJcblxyXG4gICAgICAgIGlmKCFpc1RydWUoZ2FtZUZpZWxkc0FyciwgZmlyc3RQb3NpdGlvbiwgbGFzdFNoaXBQb3NpdGlvbiwgc2hpcElzR29vZFNpemUpKXtcclxuICAgICAgICAgICAgZHJhZ2dlZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdnZWQpO1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kID0gXCJcIjtcclxuICAgICAgICAgICAgY3JlYXRlU2hpcChzaGlwTmFtZUFuZFNpemUpO1xyXG4gICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLmxhbmQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGdhbWVCb2FyZEZpZWxkcyhnYW1lRmllbGRzQXJyKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGRyYWdnZWQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkcmFnZ2VkKTtcclxuICAgICAgICAgICAgZS50YXJnZXQuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgZ2FtZUZpZWxkc0Fyci5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgZ2FtZUZpZWxkc0FycltpXS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBmaXJzdFBvc2l0aW9uKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayA9IDA7IGsgPCBsZW5ndGhTaGlwOyBrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ucG9zaXRpb24ucHVzaChnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqICsga10gPSAneCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgKyAxXVtqXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBsZW5ndGhTaGlwOyBwKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSArIDFdW2ogKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaV1baiArIGxlbmd0aFNoaXBdID0gJ3knO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihnYW1lRmllbGRzQXJyW2ldW2pdID09IGdhbWVGaWVsZHNBcnJbMF1bal0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBrID0gMDsgayA8IGxlbmd0aFNoaXA7IGsrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hpcE5hbWVBbmRTaXplW2luZGV4T2JqXS5wb3NpdGlvbi5wdXNoKGdhbWVGaWVsZHNBcnJbaV1baiArIGtdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSA9ICd4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSArIDFdW2pdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBwID0gMDsgcCA8IGxlbmd0aFNoaXA7IHArKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpICsgMV1baiArIHBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtmaXJzdFBvc2l0aW9uIC0gMV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2xhc3RTaGlwUG9zaXRpb24gKyAxXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBnYW1lRmllbGRzQXJyWzldW2pdICYmIGogIT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgPSAwOyBrIDwgbGVuZ3RoU2hpcDsgaysrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLnBvc2l0aW9uLnB1c2goZ2FtZUZpZWxkc0FycltpXVtqICsga10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaV1baiArIGtdID0gJ3gnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBwID0gMDsgcCA8IGxlbmd0aFNoaXA7IHArKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpIC0gMV1baiArIHBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtsZW5ndGhTaGlwICsgal0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogLSAxXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBnYW1lRmllbGRzQXJyWzldW2pdKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayA9IDA7IGsgPCBsZW5ndGhTaGlwOyBrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ucG9zaXRpb24ucHVzaChnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqICsga10gPSAneCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHAgPSAwOyBwIDwgbGVuZ3RoU2hpcDsgcCsrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgLSAxXVtqICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2xlbmd0aFNoaXBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayA9IDA7IGsgPCBsZW5ndGhTaGlwOyBrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ucG9zaXRpb24ucHVzaChnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqICsga10gPSAneCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgKyAxXVtqXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSAtIDFdW2pdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqIC0gMV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogKyBsZW5ndGhTaGlwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBsZW5ndGhTaGlwOyBwKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSArIDFdW2ogKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgLSAxXVtqICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZHJhZ2dlZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdnZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjcmVhdGVTaGlwKHNoaXBOYW1lQW5kU2l6ZSk7ICBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc1Bvc2l0aW9uVHJ1ZSA9IChzaGlwTmFtZUFuZFNpemUpID0+IHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzaGlwTmFtZUFuZFNpemUubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBpZihzaGlwTmFtZUFuZFNpemVbaV0ucG9zaXRpb24ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKGNvdW50ID09IDUpe1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZihpc1Bvc2l0aW9uVHJ1ZShzaGlwTmFtZUFuZFNpemUpKXtcclxuICAgICAgICBjb25zb2xlLmxvZygnc3RhcnQgZ2FtZScpXHJcbiAgICB9XHJcblxyXG4gICAgZ2FtZUJvYXJkRmllbGRzKGdhbWVGaWVsZHNBcnIpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGdhbWVGaWVsZHNBcnIpO1xyXG4gICAgY29uc29sZS5sb2coc2hpcE5hbWVBbmRTaXplKTtcclxufSwgZmFsc2UpOyJdLCJuYW1lcyI6WyJnYW1lRmllbGRzQXJyIiwiZ2FtZUJvYXJkQ2xhc3MiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImkiLCJqIiwiZ2FtZUZpZWxkIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImRhdGFzZXQiLCJyb3ciLCJjb2x1bW4iLCJhcHBlbmRDaGlsZCIsInNoaXBOYW1lQW5kU2l6ZSIsInNoaXBzQ2xhc3MiLCJsZW5ndGgiLCJsYW5kIiwic2hpcCIsImlkIiwibmFtZSIsInN0eWxlIiwiZ3JpZFRlbXBsYXRlQ29sdW1ucyIsInNpemUiLCJ3aWR0aCIsImhlaWdodCIsImJhY2tncm91bmRDb2xvciIsImRyYWdnYWJsZSIsInNxdWFyZSIsImNvbXB1dGVyQXJyIiwiY29tcHV0ZXJHYW1lYm9hcmQiLCJyb3dDaG9pY2UiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJjb2x1bW5DaG9pY2UiLCJjb3VudCIsIm5ld0FyciIsInB1c2giLCJwb3NpdGlvbiIsInNoaXBOYW1lQW5kU2l6ZUNvbXB1dGVyIiwidHJ1ZU9yRmFsc2UiLCJpdGVtIiwiZHJhZ2dlZCIsImNvdW50QXJyIiwiYiIsIngiLCJldmVyeSIsIm8iLCJmaWx0ZXIiLCJjb25zb2xlIiwibG9nIiwicSIsInZhbHVlIiwibnVtIiwidG9TdHJpbmciLCJOdW1iZXIiLCJzcGxpdCIsImZpbmRJbmRleENvbXB1dGVyIiwiZmluZEluZGV4IiwiY29tcHV0ZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsIm9wYWNpdHkiLCJmaXJzdENoaWxkIiwicHJldmVudERlZmF1bHQiLCJjbGFzc05hbWUiLCJiYWNrZ3JvdW5kIiwic2hpcElzR29vZFNpemUiLCJyZXN1bHRQb3NpdGlvbiIsInN0cmluZ1RvSW50IiwibmFtZVNoaXAiLCJsZW5ndGhTaGlwIiwiaW5kZXhPYmoiLCJmaXJzdFBvc2l0aW9uIiwibGFzdFNoaXBQb3NpdGlvbiIsInNoaXBBcnJQb3NpdGlvbiIsImlzVHJ1ZSIsIm4iLCJpbmNsdWRlcyIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImsiLCJwIiwiaXNQb3NpdGlvblRydWUiXSwic291cmNlUm9vdCI6IiJ9