(()=>{"use strict";const e=e=>{const t=document.querySelector(".ships");t.textContent="";for(let a=0;a<e.length;a++)if(1==e[a].land);else{const d=document.createElement("div");d.classList.add("ship"),d.dataset.id=e[a].id,d.classList.add(e[a].name),d.style.gridTemplateColumns=`repeat(${e[a].size}, 1fr)`,d.style.width=`calc(${e[a].id} * 50px)`,d.style.height="50px",d.style.backgroundColor="black",d.draggable=!0;for(let t=0;t<e[a].size;t++){const e=document.createElement("div");e.classList.add("square"),d.appendChild(e)}t.appendChild(d)}},t=[{name:"Destroyer",size:2,id:2,land:!1},{name:"Submarine",size:3,id:3,land:!1},{name:"Cruiser",size:3,id:3,land:!1},{name:"Battleship",size:4,id:4,land:!1},{name:"Carrier",size:5,id:5,land:!1}];let a;(()=>{const e=document.querySelector(".gameboard");for(let t=0;t<10;t++)for(let a=0;a<10;a++){const d=document.createElement("div");d.classList.add("gameField"),d.dataset.row=t,d.dataset.column=a,e.appendChild(d)}})(),e(t);const d=[];let l=0;for(let e=0;e<10;e++){const e=[];for(let t=0;t<10;t++)e.push(l),l++;d.push(e)}document.addEventListener("dragstart",(e=>{a=e.target,e.target.style.opacity=.3}),!1),document.addEventListener("dragend",(e=>{e.target.style.opacity="",e.target.dataset.row=e.target.firstChild.dataset.row,e.target.dataset.column=e.target.firstChild.dataset.column}),!1),document.addEventListener("dragover",(e=>{e.preventDefault()}),!1),document.addEventListener("dragenter",(e=>{"gameField"==e.target.className&&(e.target.style.background="yellow")}),!1),document.addEventListener("dragleave",(e=>{"gameField"==e.target.className&&(e.target.style.background="")}),!1),document.addEventListener("drop",(l=>{if(l.preventDefault(),"gameField"==l.target.className){l.target.style.background="",l.target.appendChild(a);let r=!1,s=l.target.dataset.row+l.target.dataset.column,n=Number(s);s.split("")[0],s.split("")[1];for(let e=0;e<s.split("").length;e++)0==s.split("")[0]&&(s=s.split("")[1]);const o=l.target.firstChild.className.split(" ")[1];let i,c;for(let e=0;e<t.length;e++)t[e].name==o&&(i=t[e].size,c=e);const g=n,m=n+i-1,u=[];for(let e=g;e<=m;e++)u.push(e);const p=(e,a,d,l)=>{for(let l=0;l<e.length;l++)if(e[l].includes(a))return!!e[l].includes(d)&&(!0,t[c].land=!0,true)};if(p(d,g,m,r)){l.target.style.background="",a.parentNode.removeChild(a),l.target.appendChild(a);for(let e=0;e<d.length;e++)for(let t=0;t<d[e].length;t++)if(d[e][t]==g)for(let a=0;a<i;a++)d[e][t+a]="x";a.parentNode.removeChild(a)}else a.parentNode.removeChild(a),l.target.style.background="",e(t),t[c].land=!1;e(t)}console.log(d),console.log(t)}),!1)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWN5QixHQUFHQyxTQUFTTCxNQUNSLEVBQ2pCbkQsRUFBZ0JpRCxHQUFVMUMsTUFBTyxFQURoQixPQVdqQyxHQUFJK0MsRUFBT3hCLEVBQWVvQixFQUFlQyxFQUFrQlQsR0FLdEQsQ0FDRFAsRUFBRUMsT0FBT3JCLE1BQU0wQixXQUFhLEdBQzVCaEIsRUFBUWdDLFdBQVdDLFlBQVlqQyxHQUMvQlUsRUFBRUMsT0FBT1osWUFBWUMsR0FFckIsSUFBSSxJQUFJcEIsRUFBSSxFQUFHQSxFQUFJeUIsRUFBY3hCLE9BQVFELElBQ3JDLElBQUksSUFBSWlCLEVBQUksRUFBR0EsRUFBSVEsRUFBY3pCLEdBQUdDLE9BQVFnQixJQUN4QyxHQUFHUSxFQUFjekIsR0FBR2lCLElBQU00QixFQUN0QixJQUFJLElBQUlTLEVBQUksRUFBR0EsRUFBSVgsRUFBWVcsSUFDM0I3QixFQUFjekIsR0FBR2lCLEVBQUlxQyxHQUFLLElBSzFDbEMsRUFBUWdDLFdBQVdDLFlBQVlqQyxRQWxCL0JBLEVBQVFnQyxXQUFXQyxZQUFZakMsR0FDL0JVLEVBQUVDLE9BQU9yQixNQUFNMEIsV0FBYSxHQUM1QixFQUFXekMsR0FDWEEsRUFBZ0JpRCxHQUFVMUMsTUFBTyxFQWtCckMsRUFBV1AsR0FHZjRELFFBQVFDLElBQUkvQixHQUNaOEIsUUFBUUMsSUFBSTdELE1BQ2IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvY29tcG9uZW50cy9nYW1lQm9hcmRGaWVsZHMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9jb21wb25lbnRzL2NyZWF0ZVNoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYW1lQm9hcmRGaWVsZHMgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBnYW1lQm9hcmRDbGFzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYW1lYm9hcmQnKTtcclxuXHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKyl7XHJcbiAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspe1xyXG4gICAgICAgICAgICBjb25zdCBnYW1lRmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgZ2FtZUZpZWxkLmNsYXNzTGlzdC5hZGQoJ2dhbWVGaWVsZCcpO1xyXG4gICAgICAgICAgICBnYW1lRmllbGQuZGF0YXNldC5yb3cgPSBpO1xyXG4gICAgICAgICAgICBnYW1lRmllbGQuZGF0YXNldC5jb2x1bW4gPSBqO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGdhbWVCb2FyZENsYXNzLmFwcGVuZENoaWxkKGdhbWVGaWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnYW1lQm9hcmRGaWVsZHM7IiwiY29uc3QgY3JlYXRlU2hpcCA9IChzaGlwTmFtZUFuZFNpemUpID0+IHtcclxuICAgIGNvbnN0IHNoaXBzQ2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2hpcHMnKTtcclxuXHJcbiAgICBzaGlwc0NsYXNzLnRleHRDb250ZW50ID0gJyc7XHJcblxyXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHNoaXBOYW1lQW5kU2l6ZS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgaWYoc2hpcE5hbWVBbmRTaXplW2ldLmxhbmQgPT0gdHJ1ZSl7XHJcblxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zdCBzaGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LmFkZCgnc2hpcCcpO1xyXG4gICAgICAgICAgICBzaGlwLmRhdGFzZXQuaWQgPSBzaGlwTmFtZUFuZFNpemVbaV0uaWQ7XHJcbiAgICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LmFkZChzaGlwTmFtZUFuZFNpemVbaV0ubmFtZSk7XHJcbiAgICAgICAgICAgIHNoaXAuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtzaGlwTmFtZUFuZFNpemVbaV0uc2l6ZX0sIDFmcilgO1xyXG4gICAgICAgICAgICBzaGlwLnN0eWxlLndpZHRoID0gYGNhbGMoJHtzaGlwTmFtZUFuZFNpemVbaV0uaWR9ICogNTBweClgO1xyXG4gICAgICAgICAgICBzaGlwLnN0eWxlLmhlaWdodCA9ICc1MHB4JztcclxuICAgICAgICAgICAgc2hpcC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmxhY2snOyBcclxuICAgICAgICAgICAgc2hpcC5kcmFnZ2FibGUgPSB0cnVlO1xyXG5cclxuXHJcbiAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCBzaGlwTmFtZUFuZFNpemVbaV0uc2l6ZTsgaisrKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ3NxdWFyZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoaXAuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcclxuICAgICAgICAgICAgfSAgIFxyXG5cclxuICAgICAgICAgICAgc2hpcHNDbGFzcy5hcHBlbmRDaGlsZChzaGlwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZVNoaXA7IiwiaW1wb3J0IGdhbWVCb2FyZEZpZWxkcyBmcm9tIFwiLi9jb21wb25lbnRzL2dhbWVCb2FyZEZpZWxkc1wiO1xyXG5pbXBvcnQgY3JlYXRlU2hpcCBmcm9tIFwiLi9jb21wb25lbnRzL2NyZWF0ZVNoaXBcIjtcclxuXHJcblxyXG5jb25zdCBzaGlwTmFtZUFuZFNpemUgPSBbXHJcbiAgICB7bmFtZTogJ0Rlc3Ryb3llcicsIHNpemU6IDIsIGlkOiAyLCBsYW5kOiBmYWxzZX0sXHJcbiAgICB7bmFtZTogJ1N1Ym1hcmluZScsIHNpemU6IDMsIGlkOiAzLCBsYW5kOiBmYWxzZX0sXHJcbiAgICB7bmFtZTogJ0NydWlzZXInLCBzaXplOiAzLCBpZDogMywgbGFuZDogZmFsc2V9LFxyXG4gICAge25hbWU6ICdCYXR0bGVzaGlwJywgc2l6ZTogNCwgaWQ6IDQsIGxhbmQ6IGZhbHNlfSxcclxuICAgIHtuYW1lOiAnQ2FycmllcicsIHNpemU6IDUsIGlkOiA1LCBsYW5kOiBmYWxzZX0sXHJcbl1cclxuXHJcbmNvbnN0IHNoaXAgPSAoYm9keUxlbmd0aCwgd2hlcmVIaXRzLCBzdW5rKSA9PiB7XHJcbiAgICBcclxuICAgIHJldHVybntcclxuICAgICAgICBib2R5TGVuZ3RoLFxyXG4gICAgICAgIHdoZXJlSGl0cyxcclxuICAgICAgICBzdW5rLFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBoaXQgPSAoaGl0UG9zaXRpb24pID0+IHtcclxuICAgIFxyXG4gICAgcmV0dXJue1xyXG4gICAgICAgIGhpdFBvc2l0aW9uLFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBpc1N1bmsgPSAoYm9keUxlbmd0aCkgPT4ge1xyXG4gICAgY29uc3QgaGl0cyA9IGJvZHlMZW5ndGggLSBzaGlwKCkuc3VuaztcclxuXHJcbiAgICBpZihoaXRzID09IDApe1xyXG4gICAgICAgIHJldHVybiAnc2hpcCBpcyBzdW5rJztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaGl0cztcclxufVxyXG5cclxuZ2FtZUJvYXJkRmllbGRzKCk7XHJcbmNyZWF0ZVNoaXAoc2hpcE5hbWVBbmRTaXplKTtcclxuXHJcbmxldCBkcmFnZ2VkO1xyXG5cclxuY29uc3QgZ2FtZUZpZWxkc0FyciA9IFtdO1xyXG5sZXQgY291bnQgPSAwO1xyXG5cclxuZm9yKGxldCBpID0gMDsgaSA8IDEwOyBpKyspe1xyXG4gICAgY29uc3QgbmV3QXJyID0gW107XHJcblxyXG4gICAgZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspe1xyXG4gICAgICAgIG5ld0Fyci5wdXNoKGNvdW50KTtcclxuICAgICAgICBjb3VudCsrO1xyXG4gICAgfVxyXG4gICAgZ2FtZUZpZWxkc0Fyci5wdXNoKG5ld0Fycik7XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGUpID0+IHtcclxuICAgIGRyYWdnZWQgPSBlLnRhcmdldDtcclxuXHJcbiAgICBlLnRhcmdldC5zdHlsZS5vcGFjaXR5ID0gLjM7XHJcblxyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuc3R5bGUub3BhY2l0eSA9IFwiXCI7XHJcbiAgICBlLnRhcmdldC5kYXRhc2V0LnJvdyA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuZGF0YXNldC5yb3c7XHJcbiAgICBlLnRhcmdldC5kYXRhc2V0LmNvbHVtbiA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuZGF0YXNldC5jb2x1bW47XHJcbn0sIGZhbHNlKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VudGVyXCIsIChlKSA9PiB7XHJcbiAgICBpZihlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJnYW1lRmllbGRcIil7XHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwieWVsbG93XCI7XHJcbiAgICB9XHJcbn0sIGZhbHNlKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgKGUpID0+IHtcclxuXHJcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NOYW1lID09IFwiZ2FtZUZpZWxkXCIpe1xyXG4gICAgICAgIGUudGFyZ2V0LnN0eWxlLmJhY2tncm91bmQgPSBcIlwiO1xyXG4gICAgfVxyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSAnZ2FtZUZpZWxkJyl7XHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCI7XHJcbiAgICAgICAgZS50YXJnZXQuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7XHJcblxyXG4gICAgICAgIGxldCBzaGlwSXNHb29kU2l6ZSA9IGZhbHNlO1xyXG4gXHJcbiAgICAgICAgbGV0IHJlc3VsdFBvc2l0aW9uID0gZS50YXJnZXQuZGF0YXNldC5yb3cgKyBlLnRhcmdldC5kYXRhc2V0LmNvbHVtbjtcclxuXHJcbiAgICAgICAgbGV0IHN0cmluZ1RvSW50ID0gTnVtYmVyKHJlc3VsdFBvc2l0aW9uKTtcclxuXHJcbiAgICAgICAgbGV0IHJvdyA9IHJlc3VsdFBvc2l0aW9uLnNwbGl0KCcnKVswXTtcclxuICAgICAgICBsZXQgY29sdW1uID0gcmVzdWx0UG9zaXRpb24uc3BsaXQoJycpWzFdO1xyXG4gICAgXHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHJlc3VsdFBvc2l0aW9uLnNwbGl0KCcnKS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgIGlmKHJlc3VsdFBvc2l0aW9uLnNwbGl0KCcnKVswXSA9PSAwKXtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFBvc2l0aW9uID0gcmVzdWx0UG9zaXRpb24uc3BsaXQoJycpWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgIFxyXG5cclxuICAgICAgICBjb25zdCBuYW1lU2hpcCA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuY2xhc3NOYW1lLnNwbGl0KCcgJylbMV07XHJcbiAgICAgICAgbGV0IGxlbmd0aFNoaXA7XHJcblxyXG4gICAgICAgIGxldCBpbmRleE9iajtcclxuICAgICAgICBcclxuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgc2hpcE5hbWVBbmRTaXplLmxlbmd0aDsgaisrKXtcclxuICAgICAgICAgICAgaWYoc2hpcE5hbWVBbmRTaXplW2pdLm5hbWUgPT0gbmFtZVNoaXApe1xyXG4gICAgICAgICAgICAgICAgbGVuZ3RoU2hpcCA9IHNoaXBOYW1lQW5kU2l6ZVtqXS5zaXplO1xyXG4gICAgICAgICAgICAgICAgaW5kZXhPYmogPSBqXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmlyc3RQb3NpdGlvbiA9IHN0cmluZ1RvSW50O1xyXG4gICAgICAgIGNvbnN0IGxhc3RTaGlwUG9zaXRpb24gPSBzdHJpbmdUb0ludCArIGxlbmd0aFNoaXAgLSAxO1xyXG4gICAgICAgIGNvbnN0IHNoaXBBcnJQb3NpdGlvbiA9IFtdO1xyXG5cclxuICAgICAgICBmb3IobGV0IHggPSBmaXJzdFBvc2l0aW9uOyB4IDw9IGxhc3RTaGlwUG9zaXRpb247IHgrKyl7XHJcbiAgICAgICAgICAgIHNoaXBBcnJQb3NpdGlvbi5wdXNoKHgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaXNUcnVlID0gKGdhbWVGaWVsZHNBcnIsIGZpcnN0UG9zaXRpb24sIGxhc3RTaGlwUG9zaXRpb24sIHNoaXBJc0dvb2RTaXplKSA9PiB7XHJcbiAgICAgICAgICAgIGZvcihsZXQgbiA9IDA7IG4gPCBnYW1lRmllbGRzQXJyLmxlbmd0aDsgbisrKXtcclxuICAgICAgICAgICAgICAgIGlmKGdhbWVGaWVsZHNBcnJbbl0uaW5jbHVkZXMoZmlyc3RQb3NpdGlvbikpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGdhbWVGaWVsZHNBcnJbbl0uaW5jbHVkZXMobGFzdFNoaXBQb3NpdGlvbikpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGlwSXNHb29kU2l6ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ubGFuZCA9IHRydWU7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNoaXBJc0dvb2RTaXplO1xyXG4gICAgICAgICAgICAgICAgICAgIH07IFxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNoaXBJc0dvb2RTaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCFpc1RydWUoZ2FtZUZpZWxkc0FyciwgZmlyc3RQb3NpdGlvbiwgbGFzdFNoaXBQb3NpdGlvbiwgc2hpcElzR29vZFNpemUpKXtcclxuICAgICAgICAgICAgZHJhZ2dlZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdnZWQpO1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kID0gXCJcIjtcclxuICAgICAgICAgICAgY3JlYXRlU2hpcChzaGlwTmFtZUFuZFNpemUpO1xyXG4gICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLmxhbmQgPSBmYWxzZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGRyYWdnZWQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkcmFnZ2VkKTtcclxuICAgICAgICAgICAgZS50YXJnZXQuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgZ2FtZUZpZWxkc0Fyci5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgZ2FtZUZpZWxkc0FycltpXS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBmaXJzdFBvc2l0aW9uKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBrID0gMDsgayA8IGxlbmd0aFNoaXA7IGsrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSA9ICd4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkcmFnZ2VkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZHJhZ2dlZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjcmVhdGVTaGlwKHNoaXBOYW1lQW5kU2l6ZSk7ICBcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhnYW1lRmllbGRzQXJyKTtcclxuICAgIGNvbnNvbGUubG9nKHNoaXBOYW1lQW5kU2l6ZSk7XHJcbn0sIGZhbHNlKTsiXSwibmFtZXMiOlsic2hpcE5hbWVBbmRTaXplIiwic2hpcHNDbGFzcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiaSIsImxlbmd0aCIsImxhbmQiLCJzaGlwIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImRhdGFzZXQiLCJpZCIsIm5hbWUiLCJzdHlsZSIsImdyaWRUZW1wbGF0ZUNvbHVtbnMiLCJzaXplIiwid2lkdGgiLCJoZWlnaHQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJkcmFnZ2FibGUiLCJqIiwic3F1YXJlIiwiYXBwZW5kQ2hpbGQiLCJkcmFnZ2VkIiwiZ2FtZUJvYXJkQ2xhc3MiLCJnYW1lRmllbGQiLCJyb3ciLCJjb2x1bW4iLCJnYW1lRmllbGRzQXJyIiwiY291bnQiLCJuZXdBcnIiLCJwdXNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJvcGFjaXR5IiwiZmlyc3RDaGlsZCIsInByZXZlbnREZWZhdWx0IiwiY2xhc3NOYW1lIiwiYmFja2dyb3VuZCIsInNoaXBJc0dvb2RTaXplIiwicmVzdWx0UG9zaXRpb24iLCJzdHJpbmdUb0ludCIsIk51bWJlciIsInNwbGl0IiwibmFtZVNoaXAiLCJsZW5ndGhTaGlwIiwiaW5kZXhPYmoiLCJmaXJzdFBvc2l0aW9uIiwibGFzdFNoaXBQb3NpdGlvbiIsInNoaXBBcnJQb3NpdGlvbiIsIngiLCJpc1RydWUiLCJuIiwiaW5jbHVkZXMiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJrIiwiY29uc29sZSIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=