(()=>{"use strict";const e=e=>{const t=document.querySelector(".gameboard");t.textContent="";for(let o=0;o<10;o++)for(let s=0;s<10;s++)if("x"==e[o][s]){const e=document.createElement("div");e.classList.add("checked"),e.dataset.row=o,e.dataset.column=s,t.appendChild(e)}else if("y"==e[o][s]){const e=document.createElement("div");e.classList.add("blocked"),e.dataset.row=o,e.dataset.column=s,t.appendChild(e)}else{const e=document.createElement("div");e.classList.add("gameField"),e.dataset.row=o,e.dataset.column=s,t.appendChild(e)}},t=e=>{const t=document.querySelector(".ships");t.textContent="";for(let o=0;o<e.length;o++)if(1==e[o].land);else{const s=document.createElement("div");s.classList.add("ship"),s.dataset.id=e[o].id,s.classList.add(e[o].name),s.style.gridTemplateColumns=`repeat(${e[o].size}, 1fr)`,s.style.width=`calc(${e[o].id} * 50px)`,s.style.height="50px",s.style.backgroundColor="black",s.draggable=!0;for(let t=0;t<e[o].size;t++){const e=document.createElement("div");e.classList.add("square"),s.appendChild(e)}t.appendChild(s)}},o=()=>({rowChoice:Math.floor(9*Math.random()),columnChoice:Math.floor(99*Math.random())});(()=>{const e=document.querySelector(".computerGameBoard");e.textContent="";for(let t=0;t<10;t++)for(let o=0;o<10;o++){const s=document.createElement("div");s.classList.add("field"),s.dataset.row=t,s.dataset.column=o,e.appendChild(s)}})();const s=[];let l=0;for(let e=0;e<10;e++){const e=[];for(let t=0;t<10;t++)e.push(l),l++;s.push(e)}const a=[{name:"Destroyer",size:2,id:2,land:!1,position:[]},{name:"Submarine",size:3,id:3,land:!1,position:[]},{name:"Cruiser",size:3,id:3,land:!1,position:[]},{name:"Battleship",size:4,id:4,land:!1,position:[]},{name:"Carrier",size:5,id:5,land:!1,position:[]}],i=()=>{const e=o().rowChoice,t=o().columnChoice,s=[],l=[{name:"Destroyer",size:2,id:2,land:!1,position:[]},{name:"Submarine",size:3,id:3,land:!1,position:[]},{name:"Cruiser",size:3,id:3,land:!1,position:[]},{name:"Battleship",size:4,id:4,land:!1,position:[]},{name:"Carrier",size:5,id:5,land:!1,position:[]}];let i=0;for(let e=0;e<10;e++){const e=[];for(let t=0;t<10;t++)e.push(i),i++;s.push(e)}for(let o=0;o<s.length;o++)for(let i=0;i<s[o].length;i++)if(s[e].includes(t)&&s[o].includes(t+a[0].size))for(let e=0;e<a[0].size;e++){let e=s[o].findIndex((e=>e==t));if(e>-1){for(let t=0;t<a[0].size;t++)l[0].position.push(s[o][e+t]),s[o][e+t]="T";if(o>0&&e>0){s[o+1][e]="y";for(let t=0;t<a[0].size;t++)s[o+1][e+t]="y",s[o-1][e+t]="y";s[o][e+a[0].size]="y",s[o][e-1]="y"}else if(s[o][e]==s[0][e]){s[o+1][e]="y";for(let t=0;t<a[0].size;t++)s[o+1][e+t]="y";s[o][e+a[0].size]="y",s[o][e-1]="y"}else if(s[o][e]==s[9][e]&&0!=i){for(let t=0;t<a[0].size;t++)s[o-1][e+t]="y";s[o][a[0].size+e]="y",s[o][e-1]="y"}else if(s[o][e]==s[9][e]){for(let t=0;t<a[0].size;t++)s[o-1][e+t]="y";s[o][a[0].size]="y"}else{s[o+1][e]="y",s[o-1][e]="y",s[o][e+a[0].size]="y";for(let t=0;t<a[0].size;t++)s[o+1][e+t]="y",s[o-1][e+t]="y";s[o][e-1]="y"}return{computerArr:s,shipNameAndSizeComputer:l}}return!1}};for(let e=0;e<100;e++)i()&&console.log(i());let n;i(),e(s),t(a),document.addEventListener("dragstart",(e=>{n=e.target,e.target.style.opacity=.3}),!1),document.addEventListener("dragend",(e=>{e.target.style.opacity="",e.target.dataset.row=e.target.firstChild.dataset.row,e.target.dataset.column=e.target.firstChild.dataset.column}),!1),document.addEventListener("dragover",(e=>{e.preventDefault()}),!1),document.addEventListener("dragenter",(e=>{"gameField"==e.target.className&&(e.target.style.background="yellow")}),!1),document.addEventListener("dragleave",(e=>{"gameField"==e.target.className&&(e.target.style.background="")}),!1),document.addEventListener("drop",(o=>{if(o.preventDefault(),"gameField"==o.target.className){o.target.style.background="",o.target.appendChild(n);let l=!1,i=o.target.dataset.row+o.target.dataset.column,r=Number(i);for(let e=0;e<i.split("").length;e++)0==i.split("")[0]&&(i=i.split("")[1]);const d=o.target.firstChild.className.split(" ")[1];let c,p;for(let e=0;e<a.length;e++)a[e].name==d&&(c=a[e].size,p=e);const m=r,u=r+c-1,f=[];for(let e=m;e<=u;e++)f.push(e);const g=(e,t,o,s)=>{for(let s=0;s<e.length;s++)if(e[s].includes(t))return!!e[s].includes(o)&&(!0,a[p].land=!0,true)};if(t(a),g(s,m,u,l)){o.target.style.background="",n.parentNode.removeChild(n),o.target.appendChild(n);for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)if(s[e][t]==m)if(0==s[e][t]){for(let o=0;o<c;o++)a[p].position.push(s[e][t+o]),s[e][t+o]="x";s[e+1][t]="y";for(let o=0;o<c;o++)s[e+1][t+o]="y";s[e][t+c]="y",console.log(e)}else if(s[e][t]==s[0][t]){for(let o=0;o<c;o++)a[p].position.push(s[e][t+o]),s[e][t+o]="x";s[e+1][t]="y";for(let o=0;o<c;o++)s[e+1][t+o]="y";s[e][m-1]="y",s[e][u+1]="y"}else if(s[e][t]==s[9][t]&&0!=t){for(let o=0;o<c;o++)a[p].position.push(s[e][t+o]),s[e][t+o]="x";for(let o=0;o<c;o++)s[e-1][t+o]="y";console.log(!0,!1),s[e][c+t]="y",s[e][t-1]="y"}else if(s[e][t]==s[9][t]){for(let o=0;o<c;o++)a[p].position.push(s[e][t+o]),s[e][t+o]="x";for(let o=0;o<c;o++)s[e-1][t+o]="y";console.log(!0,!1),s[e][c]="y"}else{for(let o=0;o<c;o++)a[p].position.push(s[e][t+o]),s[e][t+o]="x";s[e+1][t]="y",s[e-1][t]="y",s[e][t-1]="y",s[e][t+c]="y";for(let o=0;o<c;o++)s[e+1][t+o]="y",s[e-1][t+o]="y"}n.parentNode.removeChild(n)}else n.parentNode.removeChild(n),o.target.style.background="",t(a),a[p].land=!1,e(s);t(a)}(e=>{let t=0;for(let o=0;o<e.length;o++)e[o].position.length&&t++;return 5==t})(a)&&console.log("start game"),e(s),console.log(s),console.log(a)}),!1)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUksY0FHaEIsRUFBZ0JsRCxHQUVoQmlELFFBQVFDLElBQUlsRCxHQUNaaUQsUUFBUUMsSUFBSW5DLE1BQ2IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvY29tcG9uZW50cy9nYW1lQm9hcmRGaWVsZHMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9jb21wb25lbnRzL2NyZWF0ZVNoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9jb21wb25lbnRzL2NvbXB1dGVyQ2hvaWNlLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvY29tcG9uZW50cy9jb21wdXRlckdhbWVCb2FyZEZpZWxkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2FtZUJvYXJkRmllbGRzID0gKGdhbWVGaWVsZHNBcnIpID0+IHtcclxuICAgIGNvbnN0IGdhbWVCb2FyZENsYXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWVib2FyZCcpO1xyXG5cclxuICAgIGdhbWVCb2FyZENsYXNzLnRleHRDb250ZW50ID0gJyc7XHJcblxyXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IDEwOyBpKyspe1xyXG4gICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKXtcclxuICAgICAgICAgICAgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSAneCcpe1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ2FtZUZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQucm93ID0gaTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5kYXRhc2V0LmNvbHVtbiA9IGo7XHJcblxyXG4gICAgICAgICAgICAgICAgZ2FtZUJvYXJkQ2xhc3MuYXBwZW5kQ2hpbGQoZ2FtZUZpZWxkKTtcclxuICAgICAgICAgICAgfWVsc2UgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSAneScpe1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ2FtZUZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuY2xhc3NMaXN0LmFkZCgnYmxvY2tlZCcpO1xyXG4gICAgICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQucm93ID0gaTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5kYXRhc2V0LmNvbHVtbiA9IGo7XHJcblxyXG4gICAgICAgICAgICAgICAgZ2FtZUJvYXJkQ2xhc3MuYXBwZW5kQ2hpbGQoZ2FtZUZpZWxkKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnYW1lRmllbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5jbGFzc0xpc3QuYWRkKCdnYW1lRmllbGQnKTtcclxuICAgICAgICAgICAgICAgIGdhbWVGaWVsZC5kYXRhc2V0LnJvdyA9IGk7XHJcbiAgICAgICAgICAgICAgICBnYW1lRmllbGQuZGF0YXNldC5jb2x1bW4gPSBqO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBnYW1lQm9hcmRDbGFzcy5hcHBlbmRDaGlsZChnYW1lRmllbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnYW1lQm9hcmRGaWVsZHM7IiwiY29uc3QgY3JlYXRlU2hpcCA9IChzaGlwTmFtZUFuZFNpemUpID0+IHtcclxuICAgIGNvbnN0IHNoaXBzQ2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2hpcHMnKTtcclxuXHJcbiAgICBzaGlwc0NsYXNzLnRleHRDb250ZW50ID0gJyc7XHJcblxyXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHNoaXBOYW1lQW5kU2l6ZS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgaWYoc2hpcE5hbWVBbmRTaXplW2ldLmxhbmQgPT0gdHJ1ZSl7XHJcblxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zdCBzaGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LmFkZCgnc2hpcCcpO1xyXG4gICAgICAgICAgICBzaGlwLmRhdGFzZXQuaWQgPSBzaGlwTmFtZUFuZFNpemVbaV0uaWQ7XHJcbiAgICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LmFkZChzaGlwTmFtZUFuZFNpemVbaV0ubmFtZSk7XHJcbiAgICAgICAgICAgIHNoaXAuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtzaGlwTmFtZUFuZFNpemVbaV0uc2l6ZX0sIDFmcilgO1xyXG4gICAgICAgICAgICBzaGlwLnN0eWxlLndpZHRoID0gYGNhbGMoJHtzaGlwTmFtZUFuZFNpemVbaV0uaWR9ICogNTBweClgO1xyXG4gICAgICAgICAgICBzaGlwLnN0eWxlLmhlaWdodCA9ICc1MHB4JztcclxuICAgICAgICAgICAgc2hpcC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnYmxhY2snOyBcclxuICAgICAgICAgICAgc2hpcC5kcmFnZ2FibGUgPSB0cnVlO1xyXG5cclxuXHJcbiAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCBzaGlwTmFtZUFuZFNpemVbaV0uc2l6ZTsgaisrKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ3NxdWFyZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNoaXAuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcclxuICAgICAgICAgICAgfSAgIFxyXG5cclxuICAgICAgICAgICAgc2hpcHNDbGFzcy5hcHBlbmRDaGlsZChzaGlwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZVNoaXA7IiwiY29uc3QgY29tcHRlckNob2ljZSA9ICgpID0+IHtcclxuICAgIGNvbnN0IHJvd0Nob2ljZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDkpO1xyXG4gICAgY29uc3QgY29sdW1uQ2hvaWNlID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOTkpO1xyXG5cclxuICAgIHJldHVybntcclxuICAgICAgICByb3dDaG9pY2UsXHJcbiAgICAgICAgY29sdW1uQ2hvaWNlLFxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjb21wdGVyQ2hvaWNlOyIsImNvbnN0IGNvbXB1dGVyR2FtZUJvYXJkRmllbGQgPSAoKSA9PiB7XHJcbiAgICBcclxuICAgIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbXB1dGVyR2FtZUJvYXJkJyk7XHJcbiAgICBjb21wdXRlckdhbWVib2FyZC50ZXh0Q29udGVudCA9ICcnO1xyXG5cclxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKXtcclxuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICAgICAgICAgIGNvbnN0IGdhbWVGaWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBnYW1lRmllbGQuY2xhc3NMaXN0LmFkZCgnZmllbGQnKTtcclxuICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQucm93ID0gaTtcclxuICAgICAgICAgICAgZ2FtZUZpZWxkLmRhdGFzZXQuY29sdW1uID0gajtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb21wdXRlckdhbWVib2FyZC5hcHBlbmRDaGlsZChnYW1lRmllbGQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY29tcHV0ZXJHYW1lQm9hcmRGaWVsZDsiLCJpbXBvcnQgZ2FtZUJvYXJkRmllbGRzIGZyb20gXCIuL2NvbXBvbmVudHMvZ2FtZUJvYXJkRmllbGRzXCI7XHJcbmltcG9ydCBjcmVhdGVTaGlwIGZyb20gXCIuL2NvbXBvbmVudHMvY3JlYXRlU2hpcFwiO1xyXG5pbXBvcnQgY29tcHV0ZXJHYW1lQm9hcmRGaWVsZCBmcm9tIFwiLi9jb21wb25lbnRzL2NvbXB1dGVyR2FtZUJvYXJkRmllbGRcIjtcclxuaW1wb3J0IGNvbXB0ZXJDaG9pY2UgZnJvbSAnLi9jb21wb25lbnRzL2NvbXB1dGVyQ2hvaWNlJztcclxuXHJcblxyXG5jb21wdXRlckdhbWVCb2FyZEZpZWxkKCk7XHJcblxyXG5jb25zdCBnYW1lRmllbGRzQXJyID0gW107XHJcbmxldCBjb3VudCA9IDA7XHJcblxyXG5mb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKyl7XHJcbiAgICBjb25zdCBuZXdBcnIgPSBbXTtcclxuXHJcbiAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICAgICAgbmV3QXJyLnB1c2goY291bnQpO1xyXG4gICAgICAgIGNvdW50Kys7XHJcbiAgICB9XHJcbiAgICBnYW1lRmllbGRzQXJyLnB1c2gobmV3QXJyKTtcclxufVxyXG5cclxuY29uc3Qgc2hpcE5hbWVBbmRTaXplID0gW1xyXG4gICAge25hbWU6ICdEZXN0cm95ZXInLCBzaXplOiAyLCBpZDogMiwgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICB7bmFtZTogJ1N1Ym1hcmluZScsIHNpemU6IDMsIGlkOiAzLCBsYW5kOiBmYWxzZSwgcG9zaXRpb246IFtdfSxcclxuICAgIHtuYW1lOiAnQ3J1aXNlcicsIHNpemU6IDMsIGlkOiAzLCBsYW5kOiBmYWxzZSwgcG9zaXRpb246IFtdfSxcclxuICAgIHtuYW1lOiAnQmF0dGxlc2hpcCcsIHNpemU6IDQsIGlkOiA0LCBsYW5kOiBmYWxzZSwgcG9zaXRpb246IFtdfSxcclxuICAgIHtuYW1lOiAnQ2FycmllcicsIHNpemU6IDUsIGlkOiA1LCBsYW5kOiBmYWxzZSwgcG9zaXRpb246IFtdfSxcclxuXVxyXG5cclxuY29uc3QgY29tcHV0ZXIgPSAoKSA9PiB7XHJcbiAgICBjb25zdCByb3cgPSBjb21wdGVyQ2hvaWNlKCkucm93Q2hvaWNlO1xyXG4gICAgY29uc3QgY29sdW1uID0gY29tcHRlckNob2ljZSgpLmNvbHVtbkNob2ljZTtcclxuICAgIGNvbnN0IGNvbXB1dGVyQXJyID0gW107XHJcblxyXG4gICAgY29uc3Qgc2hpcE5hbWVBbmRTaXplQ29tcHV0ZXIgPSBbXHJcbiAgICAgICAge25hbWU6ICdEZXN0cm95ZXInLCBzaXplOiAyLCBpZDogMiwgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICAgICAge25hbWU6ICdTdWJtYXJpbmUnLCBzaXplOiAzLCBpZDogMywgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICAgICAge25hbWU6ICdDcnVpc2VyJywgc2l6ZTogMywgaWQ6IDMsIGxhbmQ6IGZhbHNlLCBwb3NpdGlvbjogW119LFxyXG4gICAgICAgIHtuYW1lOiAnQmF0dGxlc2hpcCcsIHNpemU6IDQsIGlkOiA0LCBsYW5kOiBmYWxzZSwgcG9zaXRpb246IFtdfSxcclxuICAgICAgICB7bmFtZTogJ0NhcnJpZXInLCBzaXplOiA1LCBpZDogNSwgbGFuZDogZmFsc2UsIHBvc2l0aW9uOiBbXX0sXHJcbiAgICBdXHJcblxyXG4gICAgbGV0IGNvdW50ID0gMDtcclxuXHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMTA7IGkrKyl7XHJcbiAgICAgICAgY29uc3QgbmV3QXJyID0gW107XHJcbiAgICBcclxuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICAgICAgICAgIG5ld0Fyci5wdXNoKGNvdW50KTtcclxuICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgY29tcHV0ZXJBcnIucHVzaChuZXdBcnIpO1xyXG4gICAgfVxyXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IGNvbXB1dGVyQXJyLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgY29tcHV0ZXJBcnJbaV0ubGVuZ3RoOyBqKyspe1xyXG4gICAgICAgICAgICBpZihjb21wdXRlckFycltyb3ddLmluY2x1ZGVzKGNvbHVtbikpe1xyXG4gICAgICAgICAgICAgICAgaWYoY29tcHV0ZXJBcnJbaV0uaW5jbHVkZXMoY29sdW1uICsgc2hpcE5hbWVBbmRTaXplWzBdLnNpemUpKXtcclxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHAgPSAwOyBwIDwgc2hpcE5hbWVBbmRTaXplWzBdLnNpemU7IHArKyl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmluZEluZGV4T25lID0gY29tcHV0ZXJBcnJbaV0uZmluZEluZGV4KGl0ZW0gPT4gaXRlbSA9PSBjb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZpbmRJbmRleE9uZSA+IC0xKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgbCA9IDA7IGwgPCBzaGlwTmFtZUFuZFNpemVbMF0uc2l6ZTsgbCsrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVDb21wdXRlclswXS5wb3NpdGlvbi5wdXNoKGNvbXB1dGVyQXJyW2ldW2ZpbmRJbmRleE9uZSArIGxdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpXVtmaW5kSW5kZXhPbmUgKyBsXSA9ICdUJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSA+IDAgJiYgZmluZEluZGV4T25lID4gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaSArIDFdW2ZpbmRJbmRleE9uZV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBwID0gMDsgcCA8IHNoaXBOYW1lQW5kU2l6ZVswXS5zaXplOyBwKyspe1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW2kgKyAxXVtmaW5kSW5kZXhPbmUgKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaSAtIDFdW2ZpbmRJbmRleE9uZSArIHBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpXVtmaW5kSW5kZXhPbmUgKyBzaGlwTmFtZUFuZFNpemVbMF0uc2l6ZV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaV1bZmluZEluZGV4T25lIC0gMV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihjb21wdXRlckFycltpXVtmaW5kSW5kZXhPbmVdID09IGNvbXB1dGVyQXJyWzBdW2ZpbmRJbmRleE9uZV0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW2kgKyAxXVtmaW5kSW5kZXhPbmVdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBzaGlwTmFtZUFuZFNpemVbMF0uc2l6ZTsgcCsrKXtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpICsgMV1bZmluZEluZGV4T25lICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW2ldW2ZpbmRJbmRleE9uZSArIHNoaXBOYW1lQW5kU2l6ZVswXS5zaXplXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpXVtmaW5kSW5kZXhPbmUgLSAxXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKGNvbXB1dGVyQXJyW2ldW2ZpbmRJbmRleE9uZV0gPT0gY29tcHV0ZXJBcnJbOV1bZmluZEluZGV4T25lXSAmJiBqICE9IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBzaGlwTmFtZUFuZFNpemVbMF0uc2l6ZTsgcCsrKXtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpIC0gMV1bZmluZEluZGV4T25lICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW2ldW3NoaXBOYW1lQW5kU2l6ZVswXS5zaXplICsgZmluZEluZGV4T25lXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpXVtmaW5kSW5kZXhPbmUgLSAxXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKGNvbXB1dGVyQXJyW2ldW2ZpbmRJbmRleE9uZV0gPT0gY29tcHV0ZXJBcnJbOV1bZmluZEluZGV4T25lXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBwID0gMDsgcCA8IHNoaXBOYW1lQW5kU2l6ZVswXS5zaXplOyBwKyspe1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW2kgLSAxXVtmaW5kSW5kZXhPbmUgKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaV1bc2hpcE5hbWVBbmRTaXplWzBdLnNpemVdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaSArIDFdW2ZpbmRJbmRleE9uZV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaSAtIDFdW2ZpbmRJbmRleE9uZV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaV1bZmluZEluZGV4T25lICsgc2hpcE5hbWVBbmRTaXplWzBdLnNpemVdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBzaGlwTmFtZUFuZFNpemVbMF0uc2l6ZTsgcCsrKXtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycltpICsgMV1bZmluZEluZGV4T25lICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXB1dGVyQXJyW2kgLSAxXVtmaW5kSW5kZXhPbmUgKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJBcnJbaV1bZmluZEluZGV4T25lIC0gMV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlckFycixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVDb21wdXRlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZm9yKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKXtcclxuICAgIGlmKGNvbXB1dGVyKCkpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNvbXB1dGVyKCkpO1xyXG4gICAgfVxyXG59XHJcblxyXG5jb21wdXRlcigpO1xyXG5cclxuXHJcbmNvbnN0IHNoaXAgPSAoYm9keUxlbmd0aCwgd2hlcmVIaXRzLCBzdW5rKSA9PiB7XHJcbiAgICBcclxuICAgIHJldHVybntcclxuICAgICAgICBib2R5TGVuZ3RoLFxyXG4gICAgICAgIHdoZXJlSGl0cyxcclxuICAgICAgICBzdW5rLFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBoaXQgPSAoaGl0UG9zaXRpb24pID0+IHtcclxuICAgIFxyXG4gICAgcmV0dXJue1xyXG4gICAgICAgIGhpdFBvc2l0aW9uLFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBpc1N1bmsgPSAoYm9keUxlbmd0aCkgPT4ge1xyXG4gICAgY29uc3QgaGl0cyA9IGJvZHlMZW5ndGggLSBzaGlwKCkuc3VuaztcclxuXHJcbiAgICBpZihoaXRzID09IDApe1xyXG4gICAgICAgIHJldHVybiAnc2hpcCBpcyBzdW5rJztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaGl0cztcclxufVxyXG5cclxubGV0IGRyYWdnZWQ7XHJcblxyXG5nYW1lQm9hcmRGaWVsZHMoZ2FtZUZpZWxkc0Fycik7XHJcbmNyZWF0ZVNoaXAoc2hpcE5hbWVBbmRTaXplKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGUpID0+IHtcclxuICAgIGRyYWdnZWQgPSBlLnRhcmdldDtcclxuXHJcbiAgICBlLnRhcmdldC5zdHlsZS5vcGFjaXR5ID0gLjM7XHJcblxyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuc3R5bGUub3BhY2l0eSA9IFwiXCI7XHJcbiAgICBlLnRhcmdldC5kYXRhc2V0LnJvdyA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuZGF0YXNldC5yb3c7XHJcbiAgICBlLnRhcmdldC5kYXRhc2V0LmNvbHVtbiA9IGUudGFyZ2V0LmZpcnN0Q2hpbGQuZGF0YXNldC5jb2x1bW47XHJcbn0sIGZhbHNlKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VudGVyXCIsIChlKSA9PiB7XHJcbiAgICBpZihlLnRhcmdldC5jbGFzc05hbWUgPT0gXCJnYW1lRmllbGRcIil7XHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwieWVsbG93XCI7XHJcbiAgICB9XHJcbn0sIGZhbHNlKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgKGUpID0+IHtcclxuXHJcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NOYW1lID09IFwiZ2FtZUZpZWxkXCIpe1xyXG4gICAgICAgIGUudGFyZ2V0LnN0eWxlLmJhY2tncm91bmQgPSBcIlwiO1xyXG4gICAgfVxyXG59LCBmYWxzZSk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSAnZ2FtZUZpZWxkJyl7XHJcbiAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCI7XHJcbiAgICAgICAgZS50YXJnZXQuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7XHJcblxyXG4gICAgICAgIGxldCBzaGlwSXNHb29kU2l6ZSA9IGZhbHNlO1xyXG4gXHJcbiAgICAgICAgbGV0IHJlc3VsdFBvc2l0aW9uID0gZS50YXJnZXQuZGF0YXNldC5yb3cgKyBlLnRhcmdldC5kYXRhc2V0LmNvbHVtbjtcclxuXHJcbiAgICAgICAgbGV0IHN0cmluZ1RvSW50ID0gTnVtYmVyKHJlc3VsdFBvc2l0aW9uKTtcclxuICAgIFxyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCByZXN1bHRQb3NpdGlvbi5zcGxpdCgnJykubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBpZihyZXN1bHRQb3NpdGlvbi5zcGxpdCgnJylbMF0gPT0gMCl7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRQb3NpdGlvbiA9IHJlc3VsdFBvc2l0aW9uLnNwbGl0KCcnKVsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gICBcclxuXHJcbiAgICAgICAgY29uc3QgbmFtZVNoaXAgPSBlLnRhcmdldC5maXJzdENoaWxkLmNsYXNzTmFtZS5zcGxpdCgnICcpWzFdO1xyXG4gICAgICAgIGxldCBsZW5ndGhTaGlwO1xyXG5cclxuICAgICAgICBsZXQgaW5kZXhPYmo7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHNoaXBOYW1lQW5kU2l6ZS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgIGlmKHNoaXBOYW1lQW5kU2l6ZVtqXS5uYW1lID09IG5hbWVTaGlwKXtcclxuICAgICAgICAgICAgICAgIGxlbmd0aFNoaXAgPSBzaGlwTmFtZUFuZFNpemVbal0uc2l6ZTtcclxuICAgICAgICAgICAgICAgIGluZGV4T2JqID0galxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGZpcnN0UG9zaXRpb24gPSBzdHJpbmdUb0ludDtcclxuICAgICAgICBjb25zdCBsYXN0U2hpcFBvc2l0aW9uID0gc3RyaW5nVG9JbnQgKyBsZW5ndGhTaGlwIC0gMTtcclxuICAgICAgICBjb25zdCBzaGlwQXJyUG9zaXRpb24gPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKGxldCB4ID0gZmlyc3RQb3NpdGlvbjsgeCA8PSBsYXN0U2hpcFBvc2l0aW9uOyB4Kyspe1xyXG4gICAgICAgICAgICBzaGlwQXJyUG9zaXRpb24ucHVzaCh4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGlzVHJ1ZSA9IChnYW1lRmllbGRzQXJyLCBmaXJzdFBvc2l0aW9uLCBsYXN0U2hpcFBvc2l0aW9uLCBzaGlwSXNHb29kU2l6ZSkgPT4ge1xyXG4gICAgICAgICAgICBmb3IobGV0IG4gPSAwOyBuIDwgZ2FtZUZpZWxkc0Fyci5sZW5ndGg7IG4rKyl7XHJcbiAgICAgICAgICAgICAgICBpZihnYW1lRmllbGRzQXJyW25dLmluY2x1ZGVzKGZpcnN0UG9zaXRpb24pKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihnYW1lRmllbGRzQXJyW25dLmluY2x1ZGVzKGxhc3RTaGlwUG9zaXRpb24pKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hpcElzR29vZFNpemUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLmxhbmQgPSB0cnVlO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGlwSXNHb29kU2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICB9OyBcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGlwSXNHb29kU2l6ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjcmVhdGVTaGlwKHNoaXBOYW1lQW5kU2l6ZSk7XHJcblxyXG4gICAgICAgIGlmKCFpc1RydWUoZ2FtZUZpZWxkc0FyciwgZmlyc3RQb3NpdGlvbiwgbGFzdFNoaXBQb3NpdGlvbiwgc2hpcElzR29vZFNpemUpKXtcclxuICAgICAgICAgICAgZHJhZ2dlZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdnZWQpO1xyXG4gICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kID0gXCJcIjtcclxuICAgICAgICAgICAgY3JlYXRlU2hpcChzaGlwTmFtZUFuZFNpemUpO1xyXG4gICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLmxhbmQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGdhbWVCb2FyZEZpZWxkcyhnYW1lRmllbGRzQXJyKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGRyYWdnZWQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkcmFnZ2VkKTtcclxuICAgICAgICAgICAgZS50YXJnZXQuYXBwZW5kQ2hpbGQoZHJhZ2dlZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgZ2FtZUZpZWxkc0Fyci5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgZ2FtZUZpZWxkc0FycltpXS5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBmaXJzdFBvc2l0aW9uKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayA9IDA7IGsgPCBsZW5ndGhTaGlwOyBrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ucG9zaXRpb24ucHVzaChnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqICsga10gPSAneCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgKyAxXVtqXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBsZW5ndGhTaGlwOyBwKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSArIDFdW2ogKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaV1baiArIGxlbmd0aFNoaXBdID0gJ3knO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihnYW1lRmllbGRzQXJyW2ldW2pdID09IGdhbWVGaWVsZHNBcnJbMF1bal0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBrID0gMDsgayA8IGxlbmd0aFNoaXA7IGsrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hpcE5hbWVBbmRTaXplW2luZGV4T2JqXS5wb3NpdGlvbi5wdXNoKGdhbWVGaWVsZHNBcnJbaV1baiArIGtdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSA9ICd4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSArIDFdW2pdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBwID0gMDsgcCA8IGxlbmd0aFNoaXA7IHArKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpICsgMV1baiArIHBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtmaXJzdFBvc2l0aW9uIC0gMV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2xhc3RTaGlwUG9zaXRpb24gKyAxXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBnYW1lRmllbGRzQXJyWzldW2pdICYmIGogIT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgPSAwOyBrIDwgbGVuZ3RoU2hpcDsgaysrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGlwTmFtZUFuZFNpemVbaW5kZXhPYmpdLnBvc2l0aW9uLnB1c2goZ2FtZUZpZWxkc0FycltpXVtqICsga10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaV1baiArIGtdID0gJ3gnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBwID0gMDsgcCA8IGxlbmd0aFNoaXA7IHArKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpIC0gMV1baiArIHBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtsZW5ndGhTaGlwICsgal0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogLSAxXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoZ2FtZUZpZWxkc0FycltpXVtqXSA9PSBnYW1lRmllbGRzQXJyWzldW2pdKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayA9IDA7IGsgPCBsZW5ndGhTaGlwOyBrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ucG9zaXRpb24ucHVzaChnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqICsga10gPSAneCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHAgPSAwOyBwIDwgbGVuZ3RoU2hpcDsgcCsrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgLSAxXVtqICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2xlbmd0aFNoaXBdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayA9IDA7IGsgPCBsZW5ndGhTaGlwOyBrKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBOYW1lQW5kU2l6ZVtpbmRleE9ial0ucG9zaXRpb24ucHVzaChnYW1lRmllbGRzQXJyW2ldW2ogKyBrXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqICsga10gPSAneCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgKyAxXVtqXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSAtIDFdW2pdID0gJ3knO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUZpZWxkc0FycltpXVtqIC0gMV0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2ldW2ogKyBsZW5ndGhTaGlwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgcCA9IDA7IHAgPCBsZW5ndGhTaGlwOyBwKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVGaWVsZHNBcnJbaSArIDFdW2ogKyBwXSA9ICd5JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lRmllbGRzQXJyW2kgLSAxXVtqICsgcF0gPSAneSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZHJhZ2dlZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdnZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjcmVhdGVTaGlwKHNoaXBOYW1lQW5kU2l6ZSk7ICBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc1Bvc2l0aW9uVHJ1ZSA9IChzaGlwTmFtZUFuZFNpemUpID0+IHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzaGlwTmFtZUFuZFNpemUubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBpZihzaGlwTmFtZUFuZFNpemVbaV0ucG9zaXRpb24ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKGNvdW50ID09IDUpe1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZihpc1Bvc2l0aW9uVHJ1ZShzaGlwTmFtZUFuZFNpemUpKXtcclxuICAgICAgICBjb25zb2xlLmxvZygnc3RhcnQgZ2FtZScpXHJcbiAgICB9XHJcblxyXG4gICAgZ2FtZUJvYXJkRmllbGRzKGdhbWVGaWVsZHNBcnIpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGdhbWVGaWVsZHNBcnIpO1xyXG4gICAgY29uc29sZS5sb2coc2hpcE5hbWVBbmRTaXplKTtcclxufSwgZmFsc2UpOyJdLCJuYW1lcyI6WyJnYW1lRmllbGRzQXJyIiwiZ2FtZUJvYXJkQ2xhc3MiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImkiLCJqIiwiZ2FtZUZpZWxkIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImRhdGFzZXQiLCJyb3ciLCJjb2x1bW4iLCJhcHBlbmRDaGlsZCIsInNoaXBOYW1lQW5kU2l6ZSIsInNoaXBzQ2xhc3MiLCJsZW5ndGgiLCJsYW5kIiwic2hpcCIsImlkIiwibmFtZSIsInN0eWxlIiwiZ3JpZFRlbXBsYXRlQ29sdW1ucyIsInNpemUiLCJ3aWR0aCIsImhlaWdodCIsImJhY2tncm91bmRDb2xvciIsImRyYWdnYWJsZSIsInNxdWFyZSIsInJvd0Nob2ljZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNvbHVtbkNob2ljZSIsImNvbXB1dGVyR2FtZWJvYXJkIiwiY291bnQiLCJuZXdBcnIiLCJwdXNoIiwicG9zaXRpb24iLCJjb21wdXRlciIsImNvbXB1dGVyQXJyIiwic2hpcE5hbWVBbmRTaXplQ29tcHV0ZXIiLCJpbmNsdWRlcyIsInAiLCJmaW5kSW5kZXhPbmUiLCJmaW5kSW5kZXgiLCJpdGVtIiwibCIsImNvbnNvbGUiLCJsb2ciLCJkcmFnZ2VkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJvcGFjaXR5IiwiZmlyc3RDaGlsZCIsInByZXZlbnREZWZhdWx0IiwiY2xhc3NOYW1lIiwiYmFja2dyb3VuZCIsInNoaXBJc0dvb2RTaXplIiwicmVzdWx0UG9zaXRpb24iLCJzdHJpbmdUb0ludCIsIk51bWJlciIsInNwbGl0IiwibmFtZVNoaXAiLCJsZW5ndGhTaGlwIiwiaW5kZXhPYmoiLCJmaXJzdFBvc2l0aW9uIiwibGFzdFNoaXBQb3NpdGlvbiIsInNoaXBBcnJQb3NpdGlvbiIsIngiLCJpc1RydWUiLCJuIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiayIsImlzUG9zaXRpb25UcnVlIl0sInNvdXJjZVJvb3QiOiIifQ==